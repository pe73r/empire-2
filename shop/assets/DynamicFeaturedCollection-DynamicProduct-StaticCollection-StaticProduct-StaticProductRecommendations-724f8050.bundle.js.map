{"version":3,"sources":["webpack:///./source/scripts/components/MessageBanner.js","webpack:///./source/scripts/components/Youtube.js","webpack:///./source/scripts/components/Vimeo.js","webpack:///./source/scripts/components/Video.js","webpack:///./source/scripts/components/ProductClickToZoom.js","webpack:///./source/scripts/components/ProductGallery.js","webpack:///./source/scripts/components/ProductDetails.js","webpack:///./source/scripts/helpers/Images.js","webpack:///./source/scripts/components/AddToCartFlyout.js","webpack:///./source/scripts/Layout.js","webpack:///./source/scripts/helpers/Quantity.js","webpack:///./source/scripts/Forms.js","webpack:///./source/scripts/components/RichText.js"],"names":["MessageBanner","$window","$","window","$document","document","$body","body","$bannerTemplate","$banners","header","querySelector","events","on","event","_handleDocumentClick","target","_closeEsc","off","message","type","$banner","clone","addClass","find","html","append","_bindEvents","_show","$visibleBanners","each","index","banner","_hide","push","preventDefault","e","key","dismissBanners","one","removeClass","_removeBanner","forEach","$el","splice","remove","$parent","parents","length","api","apiLoadedCallbacks","apiLoaded","onYouTubeIframeAPIReady","apiLoadedCallback","Youtube","el","videoUrl","loop","regex","id","match","onApiLoaded","_onApiLoaded","bind","isReady","onReady","_onReady","onReadyCallback","onStateChange","_onStateChange","onPlayCallback","$script","Promise","resolve","player","playVideo","pauseVideo","mute","destroy","playerVars","modestbranding","showinfo","controls","rel","playlist","YT","Player","videoId","state","data","PlayerState","BUFFERING","VimeoPlayer","urlParts","split","onProgress","_onProgress","onProgressCallback","play","pause","setVolume","unload","catch","Vimeo","ready","then","Video","options","platform","getAttribute","trim","playButton","videoEl","onPlayClick","_onPlayClick","onPauseClick","_onPauseClick","autoplay","_autoplay","video","videoData","childNodes","addEventListener","classList","add","setTimeout","removeEventListener","ProductClickToZoom","settings","slides","originalThumbnails","startIndex","selectGalleryIndex","photoswipeDialog","thumbContainer","thumbScroller","thumbScrollerButtons","querySelectorAll","closeButton","selectedSlide","innerHTML","thumbnails","selectedIndex","thumb","thumbIndex","dataset","mediaType","newThumb","cloneNode","appendChild","rimg","watch","selectedThumb","EventHandler","photoswipeSlides","slide","indexOf","src","zoom","msrc","h","imageHeight","w","imageWidth","bottomBarHeight","layout","isGreaterThanBreakpoint","photoswipeOptions","barsSize","top","bottom","fullscreenEl","zoomEl","shareEl","counterEl","arrowEl","preloaderEl","closeOnScroll","showHideOpacity","history","clickToCloseNonZoomable","timeToIdle","timeToIdleOutside","click_to_zoom","isLessThanBreakpoint","getThumbBoundsFn","pageYScroll","pageYOffset","documentElement","scrollTop","bounds","getBoundingClientRect","x","left","y","width","photoswipe","PhotoSwipe","photoswipeUi","register","close","goTo","_handleScrollButtonVisibility","_onScrollButtonClick","mouseUsed","closeOnVerticalDrag","listen","getCurrentIndex","gallerySelected","slideIndex","_adjustMobileThumbPosition","removeTrapFocus","focus","unregisterAll","closeEsc","parentNode","init","trapFocus","thumbBounds","thumbWrapperBounds","scrollLeft","offsetLeft","scrollWidth","clientWidth","scrollRight","ProductGallery","isQuickshop","viewer","navigation","navScroller","navScrollerButtons","figures","zoomButton","selected","figure","thumbnail","models","videos","selectedVideo","selectedModel","showingInitialSlide","_setupSelectedVideo","features","name","version","onLoad","viewInYourSpaceEl","_onViewInYourSpaceClick","_onModelLibraryLoad","Shopify","loadFeatures","_setSlideHeight","_onThumbnailClick","onZoomButtonClick","stopPropagation","_openImageZoom","_onResize","_setupFlickity","_selectMediaByEl","variant","featured_media","i","unwatch","_closeImageZoom","_disableHoverZoom","_disableFlickity","onPlayListener","flickity","unbindDrag","onPauseListener","bindDrag","figureEl","modelEl","galleryIndex","fullscreenEnabled","ModelViewerUI","fullscreenElement","drift","_setupHoverZoom","_adjustGalleryPositioning","button","contains","parseInt","select","_selectMediaByIndex","currentTarget","shopifyModel3dId","setAttribute","figureIndex","media","selectedMediaType","defaultModelId","shouldAutoplay","gallery_video_autoplay","videoElement","Plyr","active","gallery_video_looping","hover_zoom","selectedImage","Drift","paneContainer","inlinePane","hoverBoundingBox","handleTouch","onShow","productMain","productAlt","onHide","disable","Flickity","accessibility","adaptiveHeight","cellSelector","contain","friction","freeScroll","initialIndex","lazyLoad","percentPosition","prevNextButtons","pageDots","selectedAttraction","setGallerySize","wrapAround","flickityEvent","pointer","cellElement","model","blur","swiped","unregister","containerHeight","storedImageHeight","height","style","thumbnail_position","productGalleryThumbs","firstChild","activeButton","activeElement","insertBefore","leftmostBounds","thumbStyle","currentStyle","getComputedStyle","thumbMargin","marginLeft","wrapped","Array","prototype","some","call","maxWidth","firstElementChild","_adjustMobileThumbnailPosition","imageZoom","ProductClicktoZoom","ProductDetails","$formArea","$details","context","product","useHistory","sectionId","initialVariant","variantHelper","atcCallbacks","$form","$productAtcButton","$productVariants","$productOptions","detailsLink","detailsBaseHref","variantFields","$price","$priceMoney","$compareAtPrice","$compareAtPriceMoney","$badge","$badgeMoneySaved","$badgePercentSaved","$sku","forms","Forms","gallery","_initOptions","_switchVariant","_AddToCartFlyout","ShopifyVariants","mixedControls","selectVariant","firstLoad","val","selectMediaByVariant","_updatePrice","_updateSKU","_updateBadge","_updateButton","_updateSwatchLabel","_updateFullDetailsLink","url","handle","param","replaceState","hasComparePrice","compare_at_price","price","toggleClass","text","formatMoney","money_format","sku","parent","priceSaved","toggle","percentileSaved","Math","round","available","product_available","prop","product_unavailable","swatches_enable","swatchLabel","innerText","optionSwatchValue","formData","serializeArray","$atcButton","moneyFormat","cartRedirection","cart_redirection","AddToCartFlyout","Images","images","size","imageArray","loadImage","getSizedImageUrl","path","image","Image","removeProtocol","prefix","suffix","console","warn","replace","flyOutSelector","$atcTemplate","itemId","atcFlyOut","_onInit","_onError","_onSuccess","_onCloseAll","messageBanner","headerAnnouncement","$header","callbacks","extend","onInit","onError","onSuccess","onClose","_closeFlyOuts","_disableButton","_updateCart","_removeFlyOuts","$flyOut","quantityField","filter","quantity","value","ajax","Theme","routes","cart_add_url","dataType","done","response","imageUrl","product_title","variant_options","join","$productPriceQuantity","cart_url","secondResponse","location","href","lineItem","items","item","line_level_discount_allocations","concat","final_price","$productPriceValue","original_price","$productPriceDiscounted","show","hide","$productDiscounts","discountItemTemplate","children","first","empty","discount","$listItem","discount_application","title","$amount","amount","$subTotal","total_price","item_count","trigger","_openFlyOut","fail","errorText","responseText","JSON","parse","description","error","status","statusText","_enableButton","_closeFlyOut","$excludeFlyOut","is","attr","_removeFlyOut","documentClickEventTarget","eventHandlers","previousBreakpoint","getBreakpoints","getPropertyValue","getBreakpoint","currentBreakpoint","eventHandler","previous","current","breakpoint","inclusive","breakpoints","comparison","isBreakpoint","onBreakpointChange","offBreakpointChange","Quantity","$inputParent","$input","$selectParent","$select","_watchSelect","_watchInput","baseValue","isNaN","_validateValue","removeAttr","selector","filledClass","fieldSelector","quantityItems","$quantityWrapper","_toggleFilled","_checkFilled","quantityItem","hasClass","$target","isFilled","RichText","_initExternalLinks","groupedContent","GroupedContent","get","intelliparse","fitvids","anchors","hostname"],"mappings":";;;;;;;;;;;;;;;AAAA;;IAEqBA,a;AACnB,2BAAc;AAAA;;AAAA;;AACZ,SAAKC,OAAL,GAAeC,6CAAC,CAACC,MAAD,CAAhB;AACA,SAAKC,SAAL,GAAiBF,6CAAC,CAACG,QAAD,CAAlB;AACA,SAAKC,KAAL,GAAaJ,6CAAC,CAACG,QAAQ,CAACE,IAAV,CAAd;AACA,SAAKC,eAAL,GAAuBN,6CAAC,CAAC,wCAAD,CAAxB;AACA,SAAKO,QAAL,GAAgB,EAAhB;AAEA,SAAKC,MAAL,GAAcL,QAAQ,CAACM,aAAT,CAAuB,oBAAvB,CAAd;AACA,SAAKC,MAAL,GAAc,EAAd;AAEA,SAAKR,SAAL,CAAeS,EAAf,CAAkB,iDAAlB,EAAqE,UAAAC,KAAK,EAAI;AAC5E,WAAI,CAACC,oBAAL,CAA0BD,KAAK,CAACE,MAAhC;AACD,KAFD;AAIA,SAAKf,OAAL,CAAaY,EAAb,CAAgB,wBAAhB,EAA0C,UAAAC,KAAK;AAAA,aAAI,KAAI,CAACG,SAAL,CAAeH,KAAf,CAAJ;AAAA,KAA/C;AACD;;;;6BAEQ;AACP,WAAKV,SAAL,CAAec,GAAf,CAAmB,iDAAnB;AACA,WAAKjB,OAAL,CAAaiB,GAAb,CAAiB,wBAAjB;AACD;;;4BAEOC,Q,EAASC,I,EAAM;AACrB,UAAMC,OAAO,GAAG,KAAKb,eAAL,CAAqBc,KAArB,EAAhB;AAEAD,aAAO,CACJE,QADH,oBACwBH,IADxB,GAEGI,IAFH,CAEQ,+BAFR,EAGGC,IAHH,CAGQN,QAHR;AAKAjB,mDAAC,CAAC,KAAKQ,MAAN,CAAD,CAAegB,MAAf,CAAsBL,OAAtB;;AACA,WAAKM,WAAL,CAAiBN,OAAjB;;AACA,WAAKO,KAAL,CAAWP,OAAX;AACD;;;qCAEgB;AAAA;;AACf,UAAMQ,eAAe,GAAG3B,6CAAC,CAAC,+BAAD,CAAzB;AAEA2B,qBAAe,CAACC,IAAhB,CAAqB,UAACC,KAAD,EAAQC,MAAR,EAAmB;AACtC,cAAI,CAACC,KAAL,CAAW/B,6CAAC,CAAC8B,MAAD,CAAZ,EAAsBD,KAAtB;AACD,OAFD;AAGD;;;gCAEWV,O,EAAS;AAAA;;AACnB,WAAKT,MAAL,CAAYsB,IAAZ,CAAiB,CACfb,OAAO,CAACR,EAAR,CAAW,sBAAX,EAAmC,6BAAnC,EAAkE,UAAAC,KAAK,EAAI;AACzEA,aAAK,CAACqB,cAAN;;AACA,cAAI,CAACF,KAAL,CAAWZ,OAAX;AACD,OAHD,CADe,EAKf,KAAKpB,OAAL,CAAaY,EAAb,CAAgB,wBAAhB,EAA0C,UAAAuB,CAAC,EAAI;AAC7C,YAAIA,CAAC,CAACC,GAAF,KAAU,QAAd,EAAwB;AACtB,gBAAI,CAACJ,KAAL,CAAWZ,OAAX;AACD;AACF,OAJD,CALe,CAAjB;AAWD;;;8BAESe,C,EAAG;AACX,UAAIA,CAAC,CAACC,GAAF,KAAU,QAAd,EAAwB;AACtB,aAAKC,cAAL;AACD;AACF;;;0BAEKjB,O,EAAS;AACb,WAAKZ,QAAL,CAAcyB,IAAd,CAAmBb,OAAnB;AAEAA,aAAO,CACJE,QADH,CACY,wBADZ,EAEGgB,GAFH,CAEO,OAFP,EAEgB,YAAM;AAClBlB,eAAO,CACJmB,WADH,CACe,wBADf,EAEGjB,QAFH,CAEY,SAFZ,EAGGL,GAHH,CAGO,OAHP;AAID,OAPH;AAQD;;;0BAEKG,O,EAAoB;AAAA;;AAAA,UAAXU,KAAW,uEAAH,CAAG;AACxBV,aAAO,CACJE,QADH,CACY,yBADZ,EAEGgB,GAFH,CAEO,OAFP,EAEgB,YAAM;AAClBlB,eAAO,CACJmB,WADH,CACe,iCADf,EAEGtB,GAFH,CAEO,OAFP;;AAGA,cAAI,CAACuB,aAAL,CAAmBpB,OAAnB,EAA4BU,KAA5B;AACD,OAPH;AAQD;;;kCAEaV,O,EAASU,K,EAAO;AAC5B,UAAI,KAAKnB,MAAL,CAAYmB,KAAZ,CAAJ,EAAwB;AACtB,aAAKnB,MAAL,CAAYmB,KAAZ,EAAmBW,OAAnB,CAA2B,UAAAC,GAAG;AAAA,iBAAIA,GAAG,CAACzB,GAAJ,CAAQ,iBAAR,CAAJ;AAAA,SAA9B;AACA,aAAKN,MAAL,CAAYgC,MAAZ,CAAmBb,KAAnB,EAA0B,CAA1B;AACD;;AAED,WAAKtB,QAAL,CAAcmC,MAAd,CAAqBb,KAArB,EAA4B,CAA5B;AACAV,aAAO,CAACwB,MAAR;AACD;;;yCAEoB7B,M,EAAQ;AAC3B,UAAM8B,OAAO,GAAG5C,6CAAC,CAACc,MAAD,CAAD,CAAU+B,OAAV,CAAkB,uBAAlB,CAAhB;AACA,UAAID,OAAO,CAACE,MAAZ,EAAoB;AAEpB,WAAKV,cAAL;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzGH;AAEA,IAAMW,GAAG,GAAG,oCAAZ;AACA,IAAIC,kBAAkB,GAAG,EAAzB;AACA,IAAIC,SAAS,GAAG,KAAhB;;AAEAhD,MAAM,CAACiD,uBAAP,GAAiC,YAAM;AACrCF,oBAAkB,CAACR,OAAnB,CAA2B,UAAAW,iBAAiB;AAAA,WAAIA,iBAAiB,EAArB;AAAA,GAA5C;AACAH,oBAAkB,GAAG,EAArB;AACAC,WAAS,GAAG,IAAZ;AACD,CAJD;;IAMqBG,e;AACnB,yBAAoC;AAAA,QAAtBC,EAAsB,QAAtBA,EAAsB;AAAA,QAAlBC,QAAkB,QAAlBA,QAAkB;AAAA,QAARC,IAAQ,QAARA,IAAQ;;AAAA;;AAClC,QAAMC,KAAK,GAAG,4FAAd,CADkC,CAC0E;;AAE5G,SAAKH,EAAL,GAAUA,EAAV;AACA,SAAKI,EAAL,GAAUH,QAAQ,CAACI,KAAT,CAAeF,KAAf,EAAsB,CAAtB,KAA4B,IAAtC;AAEA,SAAKG,WAAL,GAAmB,KAAKC,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAnB;AAEA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,OAAL,GAAe,KAAKC,QAAL,CAAcH,IAAd,CAAmB,IAAnB,CAAf;AACA,SAAKI,eAAL,GAAuB,IAAvB;AACA,SAAKV,IAAL,GAAYA,IAAI,GAAG,CAAH,GAAO,CAAvB;AAEA,SAAKW,aAAL,GAAqB,KAAKC,cAAL,CAAoBN,IAApB,CAAyB,IAAzB,CAArB;AACA,SAAKO,cAAL,GAAsB,IAAtB;;AAEA,QAAInB,SAAJ,EAAe;AACb,WAAKW,YAAL;AACD,KAFD,MAEO;AACLZ,wBAAkB,CAAChB,IAAnB,CAAwB,KAAK2B,WAA7B;AACAU,sBAAO,CAACtB,GAAD,CAAP;AACD;AACF;;;;2BAEM;AAAA;;AACL,aAAO,IAAIuB,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,aAAI,CAACH,cAAL,GAAsBG,OAAtB;;AAEA,YAAI,KAAI,CAACT,OAAT,EAAkB;AAChB,eAAI,CAACU,MAAL,CAAYC,SAAZ;AACD,SAFD,MAEO;AACL,eAAI,CAACR,eAAL,GAAuB,YAAM;AAAE,iBAAI,CAACO,MAAL,CAAYC,SAAZ;AAA0B,WAAzD;AACD;AACF,OARM,CAAP;AASD;;;4BAEO;AAAA;;AACN,aAAO,IAAIH,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,cAAI,CAACH,cAAL,GAAsBG,OAAtB;;AAEA,YAAI,MAAI,CAACT,OAAT,EAAkB;AAChB,gBAAI,CAACU,MAAL,CAAYE,UAAZ;AACD,SAFD,MAEO;AACL,gBAAI,CAACT,eAAL,GAAuB,YAAM;AAAE,kBAAI,CAACO,MAAL,CAAYE,UAAZ;AAA2B,WAA1D;AACD;AACF,OARM,CAAP;AASD;;;+BAEU;AAAA;;AACT,aAAO,IAAIJ,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,cAAI,CAACH,cAAL,GAAsBG,OAAtB;;AAEA,YAAI,MAAI,CAACT,OAAT,EAAkB;AAChB,gBAAI,CAACU,MAAL,CAAYC,SAAZ;;AACA,gBAAI,CAACD,MAAL,CAAYG,IAAZ;AACD,SAHD,MAGO;AACL,gBAAI,CAACV,eAAL,GAAuB,YAAM;AAC3B,kBAAI,CAACO,MAAL,CAAYC,SAAZ;;AACA,kBAAI,CAACD,MAAL,CAAYG,IAAZ;AACD,WAHD;AAID;AACF,OAZM,CAAP;AAaD;;;6BAEQ;AACP,WAAKH,MAAL,CAAYI,OAAZ;AACD;;;mCAEc;AACb,UAAMC,UAAU,GAAG;AACjBC,sBAAc,EAAE,IADC;AAEjBC,gBAAQ,EAAE,KAFO;AAGjBC,gBAAQ,EAAE,KAHO;AAIjBzB,YAAI,EAAE,KAAKA,IAJM;AAKjB0B,WAAG,EAAE;AALY,OAAnB;;AAQA,UAAI,KAAK1B,IAAT,EAAe;AACb;AACAsB,kBAAU,CAACK,QAAX,GAAsB,KAAKzB,EAA3B;AACD;;AAED,WAAKe,MAAL,GAAc,IAAIW,EAAE,CAACC,MAAP,CAAc,KAAK/B,EAAnB,EAAuB;AACnCgC,eAAO,EAAE,KAAK5B,EADqB;AAEnCoB,kBAAU,EAAVA,UAFmC;AAGnCnE,cAAM,EAAE;AACNqD,iBAAO,EAAE,KAAKA,OADR;AAENG,uBAAa,EAAE,KAAKA;AAFd;AAH2B,OAAvB,CAAd;AAQD;;;+BAEU;AACT,WAAKJ,OAAL,GAAe,IAAf;;AAEA,UAAI,KAAKG,eAAT,EAA0B;AACxB,aAAKA,eAAL;AACD;AACF;;;mCAEcrD,K,EAAO;AACpB,UAAM0E,KAAK,GAAG1E,KAAK,CAAC2E,IAApB;;AACA,UACE,KAAKnB,cAAL,IACGkB,KAAK,KAAKH,EAAE,CAACK,WAAH,CAAeC,SAF9B,EAGE;AACA,aAAKrB,cAAL;AACA,aAAKA,cAAL,GAAsB,IAAtB;AACD;AACF;;;;;;;;;;;;;;AC1HH;AAEA,IAAMrB,SAAG,GAAG,wCAAZ;AACA,IAAIE,eAAS,GAAG,KAAhB;;IAEqByC,iB;AACnB,6BAA8B;AAAA,QAAhBrC,EAAgB,QAAhBA,EAAgB;AAAA,QAAZC,QAAY,QAAZA,QAAY;;AAAA;;AAC5B,SAAKD,EAAL,GAAUA,EAAV;AACA,QAAMsC,QAAQ,GAAGrC,QAAQ,CAACsC,KAAT,CAAe,GAAf,CAAjB;AAEA,SAAKnC,EAAL,GAAUkC,QAAQ,CAACA,QAAQ,CAAC7C,MAAT,GAAkB,CAAnB,CAAlB;AACA,SAAKmB,eAAL,GAAuB,IAAvB;AAEA,SAAKN,WAAL,GAAmB,KAAKC,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAnB;AAEA,SAAKgC,UAAL,GAAkB,KAAKC,WAAL,CAAiBjC,IAAjB,CAAsB,IAAtB,CAAlB;AACA,SAAKkC,kBAAL,GAA0B,IAA1B;;AAEA,QAAI9C,eAAJ,EAAe;AACb,WAAKW,YAAL;AACD,KAFD,MAEO;AACLS,sBAAO,CAACtB,SAAD,EAAM,KAAKY,WAAX,CAAP;AACD;AACF;;;;2BAEM;AAAA;;AACL,aAAO,IAAIW,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,aAAI,CAACwB,kBAAL,GAA0BxB,OAA1B;;AAEA,YAAItB,eAAJ,EAAe;AACb,eAAI,CAACuB,MAAL,CAAY7D,EAAZ,CAAe,MAAf,EAAuB,KAAI,CAACkF,UAA5B;;AACA,eAAI,CAACrB,MAAL,CAAYwB,IAAZ;AACD,SAHD,MAGO;AACL,eAAI,CAAC/B,eAAL,GAAuB,YAAM;AAC3B,iBAAI,CAACO,MAAL,CAAY7D,EAAZ,CAAe,MAAf,EAAuB,KAAI,CAACkF,UAA5B;;AACA,iBAAI,CAACrB,MAAL,CAAYwB,IAAZ;AACD,WAHD;AAID;AACF,OAZM,CAAP;AAaD;;;4BAEO;AAAA;;AACN,aAAO,IAAI1B,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,cAAI,CAACwB,kBAAL,GAA0BxB,OAA1B;;AAEA,YAAItB,eAAJ,EAAe;AACb,gBAAI,CAACuB,MAAL,CAAY7D,EAAZ,CAAe,OAAf,EAAwB,MAAI,CAACkF,UAA7B;;AACA,gBAAI,CAACrB,MAAL,CAAYyB,KAAZ;AACD,SAHD,MAGO;AACL,gBAAI,CAAChC,eAAL,GAAuB,YAAM;AAC3B,kBAAI,CAACO,MAAL,CAAY7D,EAAZ,CAAe,OAAf,EAAwB,MAAI,CAACkF,UAA7B;;AACA,kBAAI,CAACrB,MAAL,CAAYyB,KAAZ;AACD,WAHD;AAID;AACF,OAZM,CAAP;AAaD;;;+BAEU;AAAA;;AACT,aAAO,IAAI3B,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,cAAI,CAACwB,kBAAL,GAA0BxB,OAA1B;;AAEA,YAAItB,eAAJ,EAAe;AACb,gBAAI,CAACuB,MAAL,CAAY7D,EAAZ,CAAe,MAAf,EAAuB,MAAI,CAACkF,UAA5B;;AACA,gBAAI,CAACrB,MAAL,CAAY0B,SAAZ,CAAsB,CAAtB;;AACA,gBAAI,CAAC1B,MAAL,CAAYwB,IAAZ;AACD,SAJD,MAIO;AACL,gBAAI,CAAC/B,eAAL,GAAuB,YAAM;AAC3B,kBAAI,CAACO,MAAL,CAAY7D,EAAZ,CAAe,MAAf,EAAuB,MAAI,CAACkF,UAA5B;;AACA,kBAAI,CAACrB,MAAL,CAAY0B,SAAZ,CAAsB,CAAtB;;AACA,kBAAI,CAAC1B,MAAL,CAAYwB,IAAZ;AACD,WAJD;AAKD;AACF,OAdM,CAAP;AAeD;;;6BAEQ;AACP,WAAKxB,MAAL,CACG2B,MADH,GAEGC,KAFH;AAGD;;;mCAEc;AACb,WAAK5B,MAAL,GAAc,IAAIvE,MAAM,CAACoG,KAAP,CAAajB,MAAjB,CAAwB,KAAK/B,EAA7B,EAAiC;AAAEI,UAAE,EAAE,KAAKA;AAAX,OAAjC,CAAd;AAEA,WAAKe,MAAL,CACG8B,KADH,GAEGC,IAFH,GAGGH,KAHH;AAKAnD,qBAAS,GAAG,IAAZ;;AAEA,UAAI,KAAKgB,eAAT,EAA0B;AACxB,aAAKA,eAAL;AACD;AACF;;;kCAEa;AACZ,WAAKO,MAAL,CAAYxD,GAAZ,CAAgB,MAAhB,EAAwB,KAAK6E,UAA7B;AACA,WAAKrB,MAAL,CAAYxD,GAAZ,CAAgB,OAAhB,EAAyB,KAAK6E,UAA9B;;AAEA,UAAI,KAAKE,kBAAT,EAA6B;AAC3B,aAAKA,kBAAL;AACA,aAAKA,kBAAL,GAA0B,IAA1B;AACD;AACF;;;;;;;;;;;;;;ACxGH;AACA;;IAEqBS,W;AACnB,iBAAYnD,EAAZ,EAAgBoD,OAAhB,EAAyB;AAAA;;AACvB,SAAKpD,EAAL,GAAUA,EAAV;AACA,SAAKoD,OAAL,GAAeA,OAAf;AACA,SAAKC,QAAL,GAAgBrD,EAAE,CAACsD,YAAH,CAAgB,YAAhB,EAA8BC,IAA9B,EAAhB;AACA,SAAKC,UAAL,GAAkBxD,EAAE,CAAC5C,aAAH,CAAiB,0BAAjB,CAAlB;AACA,SAAKqG,OAAL,GAAezD,EAAE,CAAC5C,aAAH,CAAiB,sBAAjB,CAAf;AAEA,SAAKsG,WAAL,GAAmB,KAAKC,YAAL,CAAkBnD,IAAlB,CAAuB,IAAvB,CAAnB;AACA,SAAKoD,YAAL,GAAoB,KAAKC,aAAL,CAAmBrD,IAAnB,CAAwB,IAAxB,CAApB;AACA,SAAKsD,QAAL,GAAgB,KAAKC,SAAL,CAAevD,IAAf,CAAoB,IAApB,CAAhB;AAEA,SAAKwD,KAAL,GAAa,IAAb;AAEA,SAAKC,SAAL,GAAiB;AACfjE,QAAE,EAAE,KAAKyD,OAAL,CAAaS,UAAb,CAAwB,CAAxB,CADW;AAEfjE,cAAQ,EAAE,KAAKwD,OAAL,CAAaH,YAAb,CAA0B,gBAA1B,CAFK;AAGfpD,UAAI,EAAE,KAAKkD,OAAL,IAAgB,KAAKA,OAAL,CAAalD;AAHpB,KAAjB;;AAMA,YAAQ,KAAKmD,QAAb;AACE,WAAK,SAAL;AACE,aAAKW,KAAL,GAAa,IAAIjE,eAAJ,CAAY,KAAKkE,SAAjB,CAAb;AACA;;AACF,WAAK,OAAL;AACE,aAAKD,KAAL,GAAa,IAAIhB,iBAAJ,CAAU,KAAKiB,SAAf,CAAb;AACA;;AACF;AACE,aAAKD,KAAL,GAAa,IAAb;AACA;AATJ;;AAYA,SAAKhE,EAAL,CAAQmE,gBAAR,CAAyB,OAAzB,EAAkC,KAAKT,WAAvC;;AAEA,QAAI,KAAKF,UAAT,EAAqB;AACnB,UAAI,KAAKJ,OAAL,IAAgB,KAAKA,OAAL,CAAaU,QAAjC,EAA2C;AACzC,aAAKA,QAAL;AACD;;AAED,WAAKN,UAAL,CAAgBW,gBAAhB,CAAiC,OAAjC,EAA0C,KAAKT,WAA/C;AACD;AACF;;;;mCAEc;AAAA;;AACb,WAAK1D,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,eAAtB;AAEA,WAAKL,KAAL,CAAWrB,IAAX,GACGO,IADH,CACQ,YAAM;AACV,aAAI,CAAClD,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,qBAAtB;;AAEAC,kBAAU,CAAC,YAAM;AACf,eAAI,CAACtE,EAAL,CAAQoE,SAAR,CAAkB9E,MAAlB,CAAyB,eAAzB;;AACA,eAAI,CAACU,EAAL,CAAQoE,SAAR,CAAkB9E,MAAlB,CAAyB,qBAAzB;;AACA,eAAI,CAACU,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,eAAtB;AACD,SAJS,EAIP,GAJO,CAAV;AAKD,OATH;AAUD;;;oCAEe;AACd,WAAKL,KAAL,CAAWpB,KAAX;AACD;;;gCAEW;AAAA;;AACV,WAAK5C,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,eAAtB;AAEA,WAAKL,KAAL,CAAWF,QAAX,GACGZ,IADH,CACQ,YAAM;AACV,cAAI,CAAClD,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,qBAAtB;;AAEAC,kBAAU,CAAC,YAAM;AACf,gBAAI,CAACtE,EAAL,CAAQoE,SAAR,CAAkB9E,MAAlB,CAAyB,eAAzB;;AACA,gBAAI,CAACU,EAAL,CAAQoE,SAAR,CAAkB9E,MAAlB,CAAyB,qBAAzB;;AACA,gBAAI,CAACU,EAAL,CAAQoE,SAAR,CAAkBC,GAAlB,CAAsB,eAAtB;AACD,SAJS,EAIP,GAJO,CAAV;AAKD,OATH;AAUD;;;2BAEM;AACL,WAAKV,YAAL;AACD;;;4BAEO;AACN,WAAKE,aAAL;AACD;;;6BAEQ;AACP,WAAK7D,EAAL,CAAQuE,mBAAR,CAA4B,OAA5B,EAAqC,KAAKb,WAA1C;;AAEA,UAAI,KAAKF,UAAT,EAAqB;AACnB,aAAKA,UAAL,CAAgBe,mBAAhB,CAAoC,OAApC,EAA6C,KAAKb,WAAlD;AACD;;AAED,UAAI,KAAKM,KAAT,EAAgB;AACd,aAAKA,KAAL,CAAWlB,MAAX;AACD;AACF;;;8BAES;AACR,WAAKA,MAAL;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtGH;AACA;AACA;AACA;AAKA;AAEA;;IAEqB0B,qC;AACnB,oCAMG;AAAA;;AAAA,QALDC,QAKC,QALDA,QAKC;AAAA,QAJDC,MAIC,QAJDA,MAIC;AAAA,QAHDC,kBAGC,QAHDA,kBAGC;AAAA,QAFDC,UAEC,QAFDA,UAEC;AAAA,QADDC,kBACC,QADDA,kBACC;;AAAA;;AACD,SAAKJ,QAAL,GAAgBA,QAAhB;AAEA,SAAKK,gBAAL,GAAwBhI,QAAQ,CAACM,aAAT,CAAuB,mBAAvB,CAAxB;AACA,SAAK2H,cAAL,GAAsB,KAAKD,gBAAL,CAAsB1H,aAAtB,CAAoC,0BAApC,CAAtB;AACA,SAAK4H,aAAL,GAAqB,KAAKF,gBAAL,CAAsB1H,aAAtB,CAAoC,kCAApC,CAArB;AACA,SAAK6H,oBAAL,GAA4B,KAAKH,gBAAL,CAAsBI,gBAAtB,CAAuC,8BAAvC,CAA5B;AACA,SAAKC,WAAL,GAAmB,KAAKL,gBAAL,CAAsB1H,aAAtB,CAAoC,sBAApC,CAAnB;AACA,SAAKgI,aAAL,GAAqBV,MAAM,CAACE,UAAD,CAA3B;AAEA,SAAKI,aAAL,CAAmBK,SAAnB,GAA+B,EAA/B;AACA,SAAKC,UAAL,GAAkB,EAAlB;AAEA,QAAIC,aAAa,GAAGX,UAApB,CAbC,CAeD;;AACAD,sBAAkB,CAACxF,OAAnB,CAA2B,UAACqG,KAAD,EAAQC,UAAR,EAAuB;AAChD,UAAID,KAAK,CAACE,OAAN,CAAcC,SAAd,KAA4B,OAAhC,EAAyC;AACvC,YAAIf,UAAU,GAAGa,UAAjB,EAA6BF,aAAa;AAC1C;AACD;;AACD,UAAMK,QAAQ,GAAGJ,KAAK,CAACK,SAAN,CAAgB,IAAhB,CAAjB;;AACA,WAAI,CAACb,aAAL,CAAmBc,WAAnB,CAA+BF,QAA/B;;AACA,WAAI,CAACN,UAAL,CAAgB3G,IAAhB,CAAqBiH,QAArB;AACD,KARD;AAUAG,+BAAI,CAACC,KAAL,CAAW,KAAKjB,cAAhB;AAEA,SAAKkB,aAAL,GAAqB,KAAKlB,cAAL,CAAoB3H,aAApB,CAAkC,gCAAlC,CAArB;AAEA,SAAKC,MAAL,GAAc,IAAI6I,sBAAJ,EAAd,CA9BC,CAgCD;;AACA,QAAMC,gBAAgB,GAAG,EAAzB;AAEAzB,UAAM,CAACvF,OAAP,CAAe,UAAAiH,KAAK,EAAI;AACtB,UAAI,CAAC,OAAD,EAAU,gBAAV,EAA4B,OAA5B,EAAqCC,OAArC,CAA6CD,KAAK,CAACV,OAAN,CAAcC,SAA3D,IAAwE,CAAC,CAA7E,EAAgF;AAChFQ,sBAAgB,CAACxH,IAAjB,CAAsB;AACpB2H,WAAG,EAAEF,KAAK,CAACV,OAAN,CAAca,IADC;AAEpBC,YAAI,EAAEJ,KAAK,CAACV,OAAN,CAAca,IAFA;AAGpBE,SAAC,EAAEL,KAAK,CAACV,OAAN,CAAcgB,WAHG;AAIpBC,SAAC,EAAEP,KAAK,CAACV,OAAN,CAAckB;AAJG,OAAtB;AAMD,KARD,EAnCC,CA6CD;;AACA,QAAMC,eAAe,GAAGC,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,IAA4C,CAA5C,GAAgD,EAAxE;AAEA,QAAMC,iBAAiB,GAAG;AACxBxI,WAAK,EAAE+G,aADiB;AAExB0B,cAAQ,EAAE;AAAEC,WAAG,EAAE,CAAP;AAAUC,cAAM,EAAEN;AAAlB,OAFc;AAGxBO,kBAAY,EAAE,KAHU;AAIxBC,YAAM,EAAE,KAJgB;AAKxBC,aAAO,EAAE,KALe;AAMxBC,eAAS,EAAE,KANa;AAOxBC,aAAO,EAAE,KAPe;AAQxBC,iBAAW,EAAE,KARW;AASxBC,mBAAa,EAAE,KATS;AAUxBC,qBAAe,EAAE,IAVO;AAWxBC,aAAO,EAAE,KAXe;AAYxB1H,UAAI,EAAE,IAZkB;AAaxB2H,6BAAuB,EAAE,KAbD;AAcxBC,gBAAU,EAAE,KAdY;AAexBC,uBAAiB,EAAE;AAfK,KAA1B;;AAkBA,QAAI,KAAKtD,QAAL,CAAcuD,aAAd,KAAgC,QAAhC,IACElB,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,KAA6C,KAAKtC,QAAL,CAAcuD,aAAd,KAAgC,SAD/E,IAEElB,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,KAAoC,KAAKxD,QAAL,CAAcuD,aAAd,KAAgC,QAF1E,EAEqF;AACnFhB,uBAAiB,CAACkB,gBAAlB,GAAqC,YAAM;AACzC,YAAMC,WAAW,GAAGvL,MAAM,CAACwL,WAAP,IAAsBtL,QAAQ,CAACuL,eAAT,CAAyBC,SAAnE;;AACA,YAAMC,MAAM,GAAG,KAAI,CAACnD,aAAL,CAAmBhI,aAAnB,CAAiC,aAAjC,EAAgDoL,qBAAhD,EAAf;;AACA,eAAO;AAAEC,WAAC,EAAEF,MAAM,CAACG,IAAZ;AAAkBC,WAAC,EAAEJ,MAAM,CAACrB,GAAP,GAAaiB,WAAlC;AAA+CxB,WAAC,EAAE4B,MAAM,CAACK;AAAzD,SAAP;AACD,OAJD;AAKD;;AAED,SAAKC,UAAL,GAAkB,IAAIC,oBAAJ,CAChB,KAAKhE,gBADW,EAEhBiE,+BAFgB,EAGhB5C,gBAHgB,EAIhBa,iBAJgB,CAAlB;AAOA,SAAK3J,MAAL,CAAY2L,QAAZ,CAAqB,KAAK7D,WAA1B,EAAuC,OAAvC,EAAgD;AAAA,aAAM,KAAI,CAAC0D,UAAL,CAAgBI,KAAhB,EAAN;AAAA,KAAhD,EAnFC,CAoFD;;AACA,SAAK5L,MAAL,CAAY2L,QAAZ,CAAqB,KAAK7D,WAA1B,EAAuC,YAAvC,EAAqD;AAAA,aAAM,KAAI,CAAC0D,UAAL,CAAgBI,KAAhB,EAAN;AAAA,KAArD;AAEA,SAAK3D,UAAL,CAAgBnG,OAAhB,CAAwB,UAACqG,KAAD,EAAQhH,KAAR,EAAkB;AACxC,WAAI,CAACnB,MAAL,CAAY2L,QAAZ,CAAqBxD,KAArB,EAA4B,OAA5B,EAAqC,YAAM;AACzC,aAAI,CAACqD,UAAL,CAAgBK,IAAhB,CAAqB1K,KAArB;AACD,OAFD;AAGD,KAJD;AAMA,SAAKnB,MAAL,CAAY2L,QAAZ,CAAqB,KAAKhE,aAA1B,EAAyC,QAAzC,EAAmD;AAAA,aAAM,KAAI,CAACmE,6BAAL,EAAN;AAAA,KAAnD;AACA,SAAK9L,MAAL,CAAY2L,QAAZ,CAAqB,KAAK/D,oBAAL,CAA0B,CAA1B,CAArB,EAAmD,OAAnD,EAA4D;AAAA,aAAM,KAAI,CAACmE,oBAAL,CAA0B,IAA1B,CAAN;AAAA,KAA5D;AACA,SAAK/L,MAAL,CAAY2L,QAAZ,CAAqB,KAAK/D,oBAAL,CAA0B,CAA1B,CAArB,EAAmD,OAAnD,EAA4D;AAAA,aAAM,KAAI,CAACmE,oBAAL,CAA0B,KAA1B,CAAN;AAAA,KAA5D,EA/FC,CAiGD;AACA;AACA;;AACA,QAAI,KAAKP,UAAL,CAAgBzF,OAAhB,CAAwBiG,SAA5B,EAAuC;AACrC,WAAKR,UAAL,CAAgBzF,OAAhB,CAAwBkG,mBAAxB,GAA8C,KAA9C;AACD,KAFD,MAEO;AACL,WAAKT,UAAL,CAAgBU,MAAhB,CAAuB,WAAvB,EAAoC,YAAM;AACxC,aAAI,CAACV,UAAL,CAAgBzF,OAAhB,CAAwBkG,mBAAxB,GAA8C,KAA9C;AACD,OAFD;AAGD;;AAED,SAAKT,UAAL,CAAgBU,MAAhB,CAAuB,aAAvB,EAAsC,YAAM;AAC1C,UAAM/K,KAAK,GAAG,KAAI,CAACqK,UAAL,CAAgBW,eAAhB,EAAd;;AACA,UAAI,KAAI,CAACvD,aAAT,EAAwB;AACtB,aAAI,CAACA,aAAL,CAAmBP,OAAnB,CAA2B+D,eAA3B,GAA6C,KAA7C;AACD;;AACD,WAAI,CAACxD,aAAL,GAAqB,KAAI,CAACX,UAAL,CAAgB9G,KAAhB,CAArB;AACA,WAAI,CAACyH,aAAL,CAAmBP,OAAnB,CAA2B+D,eAA3B,GAA6C,IAA7C;;AAEA,UAAMC,UAAU,GAAG,KAAI,CAACzD,aAAL,CAAmB3C,YAAnB,CAAgC,oBAAhC,CAAnB;;AACA,UAAM8C,KAAK,GAAG1B,MAAM,CAACgF,UAAD,CAApB;;AAEA,WAAI,CAACC,0BAAL;;AACA,WAAI,CAACR,6BAAL;;AAEAtE,wBAAkB,CAAC6E,UAAD,CAAlB;AACA,WAAI,CAACtE,aAAL,GAAqBgB,KAArB;AACD,KAhBD;AAkBA,SAAKyC,UAAL,CAAgBU,MAAhB,CAAuB,OAAvB,EAAgC,YAAM;AACpCK,mDAAe,CAAC,KAAI,CAAC9E,gBAAN,CAAf;;AACA,WAAI,CAACM,aAAL,CAAmByE,KAAnB;;AACA,WAAI,CAAChB,UAAL,GAAkB,IAAlB;AACD,KAJD;AAMA,SAAKA,UAAL,CAAgBU,MAAhB,CAAuB,SAAvB,EAAkC,YAAM;AACtC,WAAI,CAAClM,MAAL,CAAYyM,aAAZ;;AACA,WAAI,CAACjB,UAAL,GAAkB,IAAlB;AACD,KAHD,EApIC,CAyID;;AACA,SAAKxL,MAAL,CAAY2L,QAAZ,CAAqB,KAAKjE,cAA1B,EAA0C,YAA1C,EAAwD,YAAM;AAC5D,UAAI+B,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,aAAI,CAACY,UAAL,CAAgBzF,OAAhB,CAAwBsE,aAAxB,GAAwC,IAAxC;AACD;AACF,KAJD;AAMA,SAAKrK,MAAL,CAAY2L,QAAZ,CAAqB,KAAKjE,cAA1B,EAA0C,YAA1C,EAAwD,YAAM;AAC5D,UAAI+B,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,aAAI,CAACY,UAAL,CAAgBzF,OAAhB,CAAwBsE,aAAxB,GAAwC,KAAxC;AACD;AACF,KAJD,EAhJC,CAsJD;AACA;;AACA,QAAMqC,QAAQ,GAAG,SAAXA,QAAW,CAAAlL,CAAC,EAAI;AACpB,UAAIA,CAAC,CAACC,GAAF,KAAU,QAAd,EAAwB;AACtB4F,cAAM,CAAC,CAAD,CAAN,CAAUsF,UAAV,CAAqB5M,aAArB,CAAmC,uBAAnC,EAA4DyM,KAA5D;AACD;AACF,KAJD;;AAMA,SAAKxM,MAAL,CAAY2L,QAAZ,CAAqBpM,MAArB,EAA6B,SAA7B,EAAwC,UAAAiC,CAAC;AAAA,aAAIkL,QAAQ,CAAClL,CAAD,CAAZ;AAAA,KAAzC;AAEA,SAAKgK,UAAL,CAAgBoB,IAAhB;AAEAC,2CAAS,CAAC,KAAKpF,gBAAN,CAAT;AACD;;;;iDAE4B;AAC3B;AACA;AACA,UAAIgC,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,YAAMkC,WAAW,GAAG,KAAKlE,aAAL,CAAmBuC,qBAAnB,EAApB;AACA,YAAM4B,kBAAkB,GAAG,KAAKpF,aAAL,CAAmBwD,qBAAnB,EAA3B;;AAEA,YAAI2B,WAAW,CAACzB,IAAZ,GAAmByB,WAAW,CAACvB,KAA/B,GAAuC,EAAvC,GAA4CwB,kBAAkB,CAACxB,KAAnE,EAA0E;AACxE,eAAK5D,aAAL,CAAmBqF,UAAnB,GAAgC,KAAKpE,aAAL,CAAmBqE,UAAnB,GAC5BH,WAAW,CAACvB,KADgB,GACRwB,kBAAkB,CAACxB,KADX,GACmB,EADnD;AAED,SAHD,MAGO,IAAI,KAAK3C,aAAL,CAAmBqE,UAAnB,GAAgC,KAAKtF,aAAL,CAAmBqF,UAAvD,EAAmE;AACxE,eAAKrF,aAAL,CAAmBqF,UAAnB,GAAgC,KAAKpE,aAAL,CAAmBqE,UAAnB,GAAgC,EAAhE;AACD;AACF;AACF;;;oDAE+B;AAC9B,UAAIxD,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC;AACA;AACA,YAAI,KAAKjD,aAAL,CAAmBqF,UAAnB,GAAgC,CAApC,EAAuC;AACrC,eAAKpF,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuCC,GAAvC,CAA2C,SAA3C;AACD,SAFD,MAEO;AACL,eAAKY,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuC9E,MAAvC,CAA8C,SAA9C;AACD;;AAED,YAAI,KAAK0F,aAAL,CAAmBqF,UAAnB,GAAgC,KAAKrF,aAAL,CAAmBuF,WAAnB,GAChC,KAAKvF,aAAL,CAAmBwF,WADvB,EACoC;AAClC,eAAKvF,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuCC,GAAvC,CAA2C,SAA3C;AACD,SAHD,MAGO;AACL,eAAKY,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuC9E,MAAvC,CAA8C,SAA9C;AACD;AACF,OAfD,MAeO;AACL,aAAK2F,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuC9E,MAAvC,CAA8C,SAA9C;AACA,aAAK2F,oBAAL,CAA0B,CAA1B,EAA6Bb,SAA7B,CAAuC9E,MAAvC,CAA8C,SAA9C;AACD;AACF;;;yCAEoBmL,W,EAAa;AAChC,UAAIA,WAAJ,EAAiB;AACf,aAAKzF,aAAL,CAAmBqF,UAAnB,GAAgC,KAAKrF,aAAL,CAAmBqF,UAAnB,GAAgC,GAAhE;AACD,OAFD,MAEO;AACL,aAAKrF,aAAL,CAAmBqF,UAAnB,GAAgC,KAAKrF,aAAL,CAAmBqF,UAAnB,GAAgC,GAAhE;AACD;AACF;;;6BAEQ;AACP,UAAI,KAAKxB,UAAT,EAAqB;AACnB,aAAKA,UAAL,CAAgBtH,OAAhB;AACA,aAAKsH,UAAL,GAAkB,IAAlB;AACD;AACF;;;;;;;;;;;;;;AC3OH;AACA;AACA;AACA;AAEA;AACA;AACA;;IAEqB6B,6B;AACnB,gCAA2C;AAAA;;AAAA,QAA7B1K,EAA6B,QAA7BA,EAA6B;AAAA,QAAzByE,QAAyB,QAAzBA,QAAyB;AAAA,QAAfkG,WAAe,QAAfA,WAAe;;AAAA;;AACzC,SAAK3K,EAAL,GAAUA,EAAV;AACA,SAAKyE,QAAL,GAAgBA,QAAhB;AACA,SAAKkG,WAAL,GAAmBA,WAAW,IAAI,KAAlC;AAEA,SAAKtN,MAAL,GAAc,IAAI6I,sBAAJ,EAAd;AACA,SAAK0E,MAAL,GAAc,KAAK5K,EAAL,CAAQ5C,aAAR,CAAsB,uBAAtB,CAAd;AACA,SAAKyN,UAAL,GAAkB,KAAK7K,EAAL,CAAQ5C,aAAR,CAAsB,2BAAtB,CAAlB;AACA,SAAK0N,WAAL,GAAmB,KAAK9K,EAAL,CAAQ5C,aAAR,CAAsB,yBAAtB,CAAnB;AACA,SAAK2N,kBAAL,GAA0B,KAAK/K,EAAL,CAAQkF,gBAAR,CAAyB,8BAAzB,CAA1B;AACA,SAAK8F,OAAL,GAAe,KAAKJ,MAAL,CAAY1F,gBAAZ,CAA6B,uBAA7B,CAAf;AACA,SAAKI,UAAL,GAAkB,KAAKuF,UAAL,CAAgB3F,gBAAhB,CAAiC,0BAAjC,CAAlB;AACA,SAAK+F,UAAL,GAAkB,KAAKL,MAAL,CAAYxN,aAAZ,CAA0B,uBAA1B,CAAlB;AAEA,SAAK8N,QAAL,GAAgB;AACdC,YAAM,EAAE,KAAKP,MAAL,CAAYxN,aAAZ,CAA0B,gCAA1B,CADM;AAEdgO,eAAS,EAAE,KAAKP,UAAL,CAAgBzN,aAAhB,CAA8B,gCAA9B;AAFG,KAAhB;AAKA,SAAKiO,MAAL,GAAc,EAAd;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,aAAL,GAAqB,IAArB;AACA,SAAKC,aAAL,GAAqB,IAArB;AACA,SAAKC,mBAAL,GAA2B,IAA3B;AAEA,SAAKC,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBlL,IAAzB,CAA8B,IAA9B,CAA3B;AAEA,QAAMmL,QAAQ,GAAG,EAAjB;;AACA,QAAI,KAAK3L,EAAL,CAAQ5C,aAAR,CAAsB,2BAAtB,CAAJ,EAAwD;AACtDuO,cAAQ,CAAChN,IAAT,CAAc;AACZiN,YAAI,EAAE,UADM;AAEZC,eAAO,EAAE,KAFG;AAGZC,cAAM,EAAE;AAAA,iBAAM,KAAI,CAACJ,mBAAL,EAAN;AAAA;AAHI,OAAd;AAKD;;AAED,QAAI,KAAK1L,EAAL,CAAQ5C,aAAR,CAAsB,2BAAtB,CAAJ,EAAwD;AACtD,WAAK2O,iBAAL,GAAyB,KAAK/L,EAAL,CAAQ5C,aAAR,CAAsB,mBAAtB,CAAzB;AACA,WAAKC,MAAL,CAAY2L,QAAZ,CAAqB,KAAK+C,iBAA1B,EAA6C,OAA7C,EAAsD;AAAA,eAAM,KAAI,CAACC,uBAAL,EAAN;AAAA,OAAtD;AAEAL,cAAQ,CAAChN,IAAT,CACE;AACEiN,YAAI,EAAE,iBADR;AAEEC,eAAO,EAAE,KAFX;AAGEC,cAAM,EAAE,KAAKG,mBAAL,CAAyBzL,IAAzB,CAA8B,IAA9B;AAHV,OADF;AAOAmL,cAAQ,CAAChN,IAAT,CACE;AACEiN,YAAI,EAAE,YADR;AAEEC,eAAO,EAAE;AAFX,OADF;AAMD;;AAED,QAAIF,QAAQ,CAAClM,MAAb,EAAqB;AACnB7C,YAAM,CAACsP,OAAP,CAAeC,YAAf,CAA4BR,QAA5B;AACD;;AAED,QAAI,KAAKhB,WAAT,EAAsB;AACpB5E,iCAAI,CAACC,KAAL,CAAW,KAAKhG,EAAhB,EADoB,CAEpB;AACA;AACA;;AACA,UAAI,KAAKgL,OAAL,CAAa,CAAb,EAAgBtF,OAAhB,CAAwBC,SAAxB,KAAsC,OAA1C,EAAmD;AACjDrB,kBAAU,CAAC;AAAA,iBAAM,KAAI,CAAC8H,eAAL,EAAN;AAAA,SAAD,EAA+B,GAA/B,CAAV;AACD;AACF;;AAED,SAAK/O,MAAL,CAAY2L,QAAZ,CAAqB,KAAK8B,WAA1B,EAAuC,OAAvC,EAAgD,UAAAjM,CAAC;AAAA,aAAI,KAAI,CAACwN,iBAAL,CAAuBxN,CAAvB,CAAJ;AAAA,KAAjD;AACA,SAAKxB,MAAL,CAAY2L,QAAZ,CAAqB,KAAK8B,WAA1B,EAAuC,QAAvC,EAAiD;AAAA,aAAM,KAAI,CAAC3B,6BAAL,EAAN;AAAA,KAAjD;AACA,SAAK9L,MAAL,CAAY2L,QAAZ,CAAqB,KAAK+B,kBAAL,CAAwB,CAAxB,CAArB,EAAiD,OAAjD,EAA0D;AAAA,aAAM,KAAI,CAAC3B,oBAAL,CAA0B,IAA1B,CAAN;AAAA,KAA1D;AACA,SAAK/L,MAAL,CAAY2L,QAAZ,CAAqB,KAAK+B,kBAAL,CAAwB,CAAxB,CAArB,EAAiD,OAAjD,EAA0D;AAAA,aAAM,KAAI,CAAC3B,oBAAL,CAA0B,KAA1B,CAAN;AAAA,KAA1D;;AAEA,QAAI,KAAK3E,QAAL,CAAcuD,aAAd,KAAgC,UAApC,EAAgD;AAC9C,UAAMsE,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAzN,CAAC,EAAI;AAC7BA,SAAC,CAAC0N,eAAF;;AACA,aAAI,CAACC,cAAL;AACD,OAHD;;AAKA,WAAKnP,MAAL,CAAY2L,QAAZ,CAAqB,KAAKiC,UAA1B,EAAsC,OAAtC,EAA+C,UAAApM,CAAC;AAAA,eAAIyN,iBAAiB,CAACzN,CAAD,CAArB;AAAA,OAAhD;AACA,WAAKxB,MAAL,CAAY2L,QAAZ,CAAqB,KAAK4B,MAA1B,EAAkC,OAAlC,EAA2C,UAAA/L,CAAC;AAAA,eAAIyN,iBAAiB,CAACzN,CAAD,CAArB;AAAA,OAA5C;AACD;;AAED,SAAK4N,SAAL,GAAiB,KAAKA,SAAL,CAAejM,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKnD,MAAL,CAAY2L,QAAZ,CAAqBpM,MAArB,EAA6B,QAA7B,EAAuC;AAAA,aAAM,KAAI,CAAC6P,SAAL,EAAN;AAAA,KAAvC;;AAEA,QAAI3F,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,WAAKyE,cAAL;;AACA,WAAKvD,6BAAL;AACD;;AAED,SAAKwD,gBAAL,CAAsB,KAAKzB,QAAL,CAAcC,MAApC;AACD;;;;yCAEoByB,O,EAAS;AAC5B,UAAI,CAACA,OAAO,CAACC,cAAb,EAA6B;AAC7B,UAAMzG,KAAK,GAAG,KAAKwE,MAAL,CAAYxN,aAAZ,yBAA0CwP,OAAO,CAACC,cAAR,CAAuBzM,EAAjE,SAAd;;AAEA,WAAKuM,gBAAL,CAAsBvG,KAAtB;AACD;;;6BAEQ;AACP,WAAK/I,MAAL,CAAYyM,aAAZ;;AAEA,WAAK,IAAIgD,CAAT,EAAYA,CAAC,GAAG,KAAK9B,OAAL,CAAavL,MAA7B,EAAqCqN,CAAC,EAAtC,EAA0C;AACxC,YAAI,KAAKzB,MAAL,CAAYyB,CAAZ,CAAJ,EAAoB;AAClB,eAAKzB,MAAL,CAAYyB,CAAZ,EAAevL,OAAf;AACD;;AAED,YAAI,KAAK+J,MAAL,CAAYwB,CAAZ,CAAJ,EAAoB;AAClB,eAAKxB,MAAL,CAAYwB,CAAZ,EAAevL,OAAf;AACD;AACF;;AAED,UAAI,KAAKoJ,WAAT,EAAsB;AACpB5E,mCAAI,CAACgH,OAAL,CAAa,KAAK/M,EAAlB;AACD;;AAED,WAAKgN,eAAL;;AACA,WAAKC,iBAAL;;AACA,WAAKC,gBAAL;AACD;;;0CAEqB;AAAA;;AACpB,UAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3B,YAAI,MAAI,CAACC,QAAT,EAAmB;AACjB,gBAAI,CAACA,QAAL,CAAcC,UAAd;AACD;AACF,OAJD;;AAKA,UAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAC5B,YAAI,MAAI,CAACF,QAAT,EAAmB;AACjB,gBAAI,CAACA,QAAL,CAAcG,QAAd;AACD;AACF,OAJD;;AAKA,WAAKvN,EAAL,CAAQkF,gBAAR,CAAyB,yBAAzB,EACG/F,OADH,CACW,UAAAqO,QAAQ,EAAI;AACnB,YAAMC,OAAO,GAAGD,QAAQ,CAACpQ,aAAT,CAAuB,cAAvB,CAAhB;AADmB,YAEXsQ,YAFW,GAEMF,QAAQ,CAAC9H,OAFf,CAEXgI,YAFW;AAGnB,YAAM/L,QAAQ,GAAG,CAAC,SAAD,EAAY,UAAZ,CAAjB;AACA,YAAI7E,QAAQ,CAAC6Q,iBAAb,EAAgChM,QAAQ,CAAChD,IAAT,CAAc,YAAd;AAEhC,cAAI,CAAC0M,MAAL,CAAYqC,YAAZ,IAA4B,IAAIxB,OAAO,CAAC0B,aAAZ,CAA0BH,OAA1B,EAAmC;AAAE9L,kBAAQ,EAARA;AAAF,SAAnC,CAA5B;;AAEA,cAAI,CAACtE,MAAL,CAAY2L,QAAZ,CAAqByE,OAArB,EAA8B,qCAA9B,EAAqEN,cAArE;;AACA,cAAI,CAAC9P,MAAL,CAAY2L,QAAZ,CAAqByE,OAArB,EAA8B,sCAA9B,EAAsEH,eAAtE;AACD,OAXH;AAYD;;;gCAEW;AACV;AACA,UAAIxQ,QAAQ,CAAC+Q,iBAAb,EAAgC;AAC9B;AACD;;AAED,UAAI/G,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,CAAJ,EAA+C;AAC7C,aAAKmG,gBAAL;AACD,OAFD,MAEO;AACL,aAAKR,cAAL;AACD;;AAED,UAAI5F,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,KAA6C,CAAC,KAAK+G,KAAvD,EAA8D;AAC5D,aAAKC,eAAL;AACD,OAFD,MAEO,IAAIjH,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AAC3C,aAAKgF,iBAAL;AACD;;AAED,WAAKe,yBAAL;;AACA,WAAK7E,6BAAL;AACD;;;sCAEiBtK,C,EAAG;AACnB,UAAIoP,MAAJ;AACA,WAAKxC,mBAAL,GAA2B,KAA3B,CAFmB,CAInB;AACA;;AACA,UAAI5M,CAAC,CAACpB,MAAF,CAAS2G,SAAT,CAAmB8J,QAAnB,CAA4B,kCAA5B,CAAJ,EAAqE;AACnED,cAAM,GAAGpP,CAAC,CAACpB,MAAX;AACD,OAFD,MAEO,IAAIoB,CAAC,CAACpB,MAAF,CAASuM,UAAT,CAAoBA,UAApB,CAA+B5F,SAA/B,CACR8J,QADQ,CACC,kCADD,CAAJ,EAC0C;AAC/CD,cAAM,GAAGpP,CAAC,CAACpB,MAAF,CAASuM,UAAT,CAAoBA,UAA7B;AACD,OAHM,MAGA;AACL;AACD;;AAED,UAAMzE,aAAa,GAAG4I,QAAQ,CAACF,MAAM,CAACvI,OAAP,CAAegI,YAAhB,EAA8B,EAA9B,CAA9B;;AAEA,UAAI,KAAKN,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAcgB,MAAd,CAAqB7I,aAArB;AACD,OAFD,MAEO;AACL,aAAK8I,mBAAL,CAAyB9I,aAAzB;AACD;AACF;;;4CAEuB1G,C,EAAG;AAAA,UACjByP,aADiB,GACCzP,CADD,CACjByP,aADiB;AAEzB,UAAMnD,MAAM,GAAG,KAAKP,MAAL,CAAYxN,aAAZ,yBAA0CkR,aAAa,CAAC5I,OAAd,CAAsB6I,gBAAhE,SAAf;;AAEA,WAAK5B,gBAAL,CAAsBxB,MAAtB;AACD;;;qCAEgBnL,E,EAAI;AACnB,WAAKqO,mBAAL,CAAyBF,QAAQ,CAACnO,EAAE,CAAC0F,OAAH,CAAWgI,YAAZ,EAA0B,EAA1B,CAAjC;AACD;;;wCAEmBlP,K,EAAO;AACzB,UAAM2M,MAAM,GAAG,KAAKH,OAAL,CAAaxM,KAAb,CAAf;AAEA,WAAK0M,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6B+D,eAA7B,GAA+C,KAA/C;AACA,WAAKyB,QAAL,CAAcC,MAAd,CAAqBqD,YAArB,CAAkC,aAAlC,EAAiD,IAAjD;AACA,WAAKtD,QAAL,CAAcC,MAAd,GAAuBA,MAAvB;AACA,WAAKD,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6B+D,eAA7B,GAA+C,IAA/C;AACA,WAAKyB,QAAL,CAAcC,MAAd,CAAqBqD,YAArB,CAAkC,aAAlC,EAAiD,KAAjD;AAEA,UAAMC,WAAW,GAAGN,QAAQ,CAAC,KAAKjD,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6BgI,YAA9B,EAA4C,EAA5C,CAA5B;AAEA,WAAKxC,QAAL,CAAcE,SAAd,CAAwB1F,OAAxB,CAAgC+D,eAAhC,GAAkD,KAAlD;AACA,WAAKyB,QAAL,CAAcE,SAAd,GAA0B,KAAK9F,UAAL,CAAgBmJ,WAAhB,CAA1B;AACA,WAAKvD,QAAL,CAAcE,SAAd,CAAwB1F,OAAxB,CAAgC+D,eAAhC,GAAkD,IAAlD;AAbyB,kCAeI,KAAKyB,QAAL,CAAcC,MAAd,CAAqBzF,OAfzB;AAAA,UAejBgJ,KAfiB,yBAejBA,KAfiB;AAAA,UAeV/I,SAfU,yBAeVA,SAfU;AAiBzB,WAAKiF,MAAL,CAAYlF,OAAZ,CAAoBiJ,iBAApB,GAAwChJ,SAAxC;;AAEA,WAAKsH,iBAAL;;AAEA,UAAI,KAAKzB,aAAT,EAAwB;AACtB,aAAKA,aAAL,CAAmB5I,KAAnB;AACD;;AAED,UAAI,KAAKyI,MAAL,CAAYF,MAAM,CAACzF,OAAP,CAAegI,YAA3B,CAAJ,EAA8C;AAC5C,aAAKlC,aAAL,GAAqB,KAAKH,MAAL,CAAYF,MAAM,CAACzF,OAAP,CAAegI,YAA3B,CAArB;;AACA,YAAI,CAAC5Q,QAAQ,CAACuL,eAAT,CAAyBjE,SAAzB,CAAmC8J,QAAnC,CAA4C,WAA5C,CAAD,IAA6D,CAAC,KAAKzC,mBAAvE,EAA4F;AAC1F,eAAKD,aAAL,CAAmB7I,IAAnB;AACD;AACF;;AAED,UAAI,KAAK4I,aAAT,EAAwB;AACtB,aAAKA,aAAL,CAAmB3I,KAAnB;AACD;;AAED,UAAI,KAAKmJ,iBAAT,EAA4B;AAC1B,aAAKA,iBAAL,CAAuBrG,OAAvB,CAA+B6I,gBAA/B,GAAkD,KAAKxC,iBAAL,CAAuBrG,OAAvB,CAA+BkJ,cAAjF;AACD;;AAED,cAAQjJ,SAAR;AACE,aAAK,OAAL;AACE,eAAKoG,iBAAL,CAAuBrG,OAAvB,CAA+B6I,gBAA/B,GAAkDG,KAAlD;AACA;;AACF,aAAK,OAAL;AACA,aAAK,gBAAL;AACE,eAAKhD,mBAAL;;AACA;;AACF,aAAK,OAAL;AACE,eAAKqC,eAAL;;AACA;;AACF;AAAS;AAXX;;AAcA,UAAI,KAAKX,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAcG,QAAd;AACA,aAAKH,QAAL,CAAcgB,MAAd,CAAqB5P,KAArB;AACD;;AAED,WAAKwP,yBAAL;AACD;;;0CAEqB;AACpB,UAAI,KAAKzC,aAAT,EAAwB;AACtB,aAAKA,aAAL,CAAmB3I,KAAnB;AACD;;AAHmB,mCAKgB,KAAKsI,QAAL,CAAcC,MAAd,CAAqBzF,OALrC;AAAA,UAKZC,SALY,0BAKZA,SALY;AAAA,UAKD+H,YALC,0BAKDA,YALC;AAMpB,UAAMmB,cAAc,GAAG/H,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,KAClB,KAAKtC,QAAL,CAAcqK,sBADI,IAElB,CAAC,KAAKrD,mBAFX;;AAIA,UAAI9F,SAAS,KAAK,OAAd,IAAyBA,SAAS,KAAK,gBAA3C,EAA6D;AAC3D,YAAIoJ,YAAJ;;AAEA,YAAI,KAAKzD,MAAL,CAAYoC,YAAZ,CAAJ,EAA+B;AAC7B,eAAKnC,aAAL,GAAqB,KAAKD,MAAL,CAAYoC,YAAZ,CAArB;AACA,cAAImB,cAAJ,EAAoB,KAAKtD,aAAL,CAAmB5I,IAAnB;AACrB,SAHD,MAGO;AACL,cAAIgD,SAAS,KAAK,OAAlB,EAA2B;AACzB;AACA,gBAAI,CAACuG,OAAO,CAAC8C,IAAb,EAAmB;AACnBD,wBAAY,GAAG,KAAK7D,QAAL,CAAcC,MAAd,CAAqB/N,aAArB,CAAmC,OAAnC,CAAf;AAEA,iBAAKmO,aAAL,GAAqB,IAAIW,OAAO,CAAC8C,IAAZ,CAAiBD,YAAjB,EAA+B;AAClD7O,kBAAI,EAAE;AAAE+O,sBAAM,EAAE,KAAKxK,QAAL,CAAcyK;AAAxB;AAD4C,aAA/B,CAArB;AAGA,gBAAIL,cAAJ,EAAoB,KAAKtD,aAAL,CAAmB5I,IAAnB;AACrB,WATD,MASO;AACLoM,wBAAY,GAAG,KAAK7D,QAAL,CAAcC,MAAd,CAAqB/N,aAArB,CAAmC,cAAnC,CAAf;AACA,iBAAKmO,aAAL,GAAqB,IAAIpI,wBAAJ,CAAU4L,YAAV,EAAwB;AAC3C7O,kBAAI,EAAE,KAAKuE,QAAL,CAAcyK;AADuB,aAAxB,CAArB;AAGA,gBAAIL,cAAJ,EAAoB,KAAKtD,aAAL,CAAmB5I,IAAnB;AACrB;;AACD,eAAK2I,MAAL,CAAYoC,YAAZ,IAA4B,KAAKnC,aAAjC;AACD;;AACD,aAAKL,QAAL,CAAcC,MAAd,CAAqBtB,KAArB;AACD;AACF;;;sCAEiB;AAAA;;AAChB,UACE,KAAKpF,QAAL,CAAc0K,UAAd,KAA6B,UAA7B,IACG,CAACrI,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,CADJ,IAEG,KAAKmE,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6BC,SAA7B,KAA2C,OAF9C,IAGG7I,QAAQ,CAACuL,eAAT,CAAyBjE,SAAzB,CAAmC8J,QAAnC,CAA4C,WAA5C,CAJL,EAKE;AAEF,UAAMkB,aAAa,GAAG,KAAKlE,QAAL,CAAcC,MAAd,CAAqB/N,aAArB,CAAmC,aAAnC,CAAtB;AACAgS,mBAAa,CAACZ,YAAd,CAA2B,WAA3B,EAAwC,KAAKtD,QAAL,CAAcC,MAAd,CAAqB7H,YAArB,CAAkC,WAAlC,CAAxC;AAEA,WAAKwK,KAAL,GAAa,IAAIuB,wBAAJ,CAAUD,aAAV,EAAyB;AACpCE,qBAAa,EAAE,KAAK7K,QAAL,CAAc0K,UAAd,KAA6B,UAA7B,GACX,KAAKnP,EAAL,CAAQ5C,aAAR,CAAsB,qBAAtB,CADW,GAEX,KAAK8N,QAAL,CAAcC,MAHkB;AAIpCoE,kBAAU,EAAE,KAJwB;AAKpCC,wBAAgB,EAAE,KAAK/K,QAAL,CAAc0K,UAAd,KAA6B,UALX;AAMpCM,mBAAW,EAAE,KANuB;AAOpCC,cAAM,EAAE,kBAAM;AACZ,cAAI,MAAI,CAACjL,QAAL,CAAc0K,UAAd,KAA6B,UAAjC,EAA6C;AAC3C,gBAAMQ,WAAW,GAAG7S,QAAQ,CAACM,aAAT,CAAuB,eAAvB,CAApB;AACA,gBAAMwS,UAAU,GAAG9S,QAAQ,CAACM,aAAT,CAAuB,oBAAvB,CAAnB;AACAuS,uBAAW,CAACvL,SAAZ,CAAsBC,GAAtB,CAA0B,uBAA1B;AACA,gBAAIuL,UAAJ,EAAgBA,UAAU,CAACxL,SAAX,CAAqBC,GAArB,CAAyB,uBAAzB;AACjB;AACF,SAdmC;AAepCwL,cAAM,EAAE,kBAAM;AACZ,cAAI,MAAI,CAACpL,QAAL,CAAc0K,UAAd,KAA6B,UAAjC,EAA6C;AAC3C,gBAAMQ,WAAW,GAAG7S,QAAQ,CAACM,aAAT,CAAuB,eAAvB,CAApB;AACA,gBAAMwS,UAAU,GAAG9S,QAAQ,CAACM,aAAT,CAAuB,oBAAvB,CAAnB;AACAuS,uBAAW,CAACvL,SAAZ,CAAsB9E,MAAtB,CAA6B,uBAA7B;AACA,gBAAIsQ,UAAJ,EAAgBA,UAAU,CAACxL,SAAX,CAAqB9E,MAArB,CAA4B,uBAA5B;AACjB;AACF;AAtBmC,OAAzB,CAAb;AAwBD;;;wCAEmB;AAClB,UAAI,KAAKwO,KAAT,EAAgB;AACd,aAAKA,KAAL,CAAWgC,OAAX;AACA,aAAKhC,KAAL,GAAa,IAAb;AACD;AACF;;;qCAEgB;AAAA;;AACf,UACE,KAAKV,QAAL,IACG,CAACtG,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAFN,EAGE;AAEF,WAAKmF,QAAL,GAAgB,IAAI2C,YAAJ,CAAa,KAAKnF,MAAlB,EAA0B;AACxCoF,qBAAa,EAAE,KADyB;AAExCC,sBAAc,EAAE,IAFwB;AAGxCC,oBAAY,EAAE,yBAH0B;AAIxCC,eAAO,EAAE,IAJ+B;AAKxCC,gBAAQ,EAAE,GAL8B;AAMxCC,kBAAU,EAAE,KAN4B;AAOxCC,oBAAY,EAAEnC,QAAQ,CAAC,KAAKjD,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6BgI,YAA9B,EAA4C,EAA5C,CAPkB;AAQxC6C,gBAAQ,EAAE,KAR8B;AASxCC,uBAAe,EAAE,KATuB;AAUxCC,uBAAe,EAAE,KAVuB;AAWxCC,gBAAQ,EAAE,KAX8B;AAYxCC,0BAAkB,EAAE,GAZoB;AAaxCC,sBAAc,EAAE,KAbwB;AAcxCC,kBAAU,EAAE;AAd4B,OAA1B,CAAhB;AAiBA,WAAKC,aAAL,GAAqB,KAAKzT,MAAL,CAAY2L,QAAZ,CAAqB,KAAK4B,MAA1B,EAAkC,WAAlC,EAA+C,YAAM;AACxE,cAAI,CAACwB,eAAL;AACD,OAFoB,CAArB;AAIA,WAAKgB,QAAL,CAAc9P,EAAd,CAAiB,QAAjB,EAA2B,UAAAkB,KAAK,EAAI;AAClC,cAAI,CAACiN,mBAAL,GAA2B,KAA3B;;AACA,cAAI,CAACkB,gBAAL,CAAsB,MAAI,CAAC3B,OAAL,CAAaxM,KAAb,CAAtB;AACD,OAHD,EA3Be,CAgCf;AACA;;AACA,WAAK4O,QAAL,CAAc9P,EAAd,CAAiB,aAAjB,EAAgC,UAACC,KAAD,EAAQwT,OAAR,EAAiBC,WAAjB,EAAiC;AAC/D,YAAM7F,MAAM,GAAG6F,WAAW,CAAC5T,aAAZ,CAA0B,yBAA1B,CAAf;;AAEA,YAAI+N,MAAM,IAAI,MAAI,CAACE,MAAL,CAAYF,MAAM,CAACzF,OAAP,CAAegI,YAA3B,CAAd,EAAwD;AACtD,cAAMuD,KAAK,GAAG,MAAI,CAAC5F,MAAL,CAAYF,MAAM,CAACzF,OAAP,CAAegI,YAA3B,CAAd;AACAuD,eAAK,CAACtO,IAAN;AACD;AACF,OAPD;AASA,WAAKyK,QAAL,CAAc9P,EAAd,CAAiB,aAAjB,EAAgC,YAAM;AACpC;AACA,cAAI,CAACsN,MAAL,CAAYsG,IAAZ;AACD,OAHD,EA3Ce,CAgDf;AACA;;AACA,UAAI,KAAKzM,QAAL,CAAcuD,aAAd,KAAgC,UAAhC,IACClL,QAAQ,CAACuL,eAAT,CAAyBjE,SAAzB,CAAmC8J,QAAnC,CAA4C,UAA5C,CADL,EAC8D;AAC5D,aAAKd,QAAL,CAAc9P,EAAd,CAAiB,SAAjB,EAA4B,YAAM;AAChC,gBAAI,CAAC6T,MAAL,GAAc,IAAd;AACD,SAFD;AAGD;;AAED,WAAK/E,eAAL;AACD;;;uCAEkB;AACjB,UAAI,KAAKgB,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAc7L,OAAd;AACA,aAAK6L,QAAL,GAAgB,IAAhB;AACA,aAAK/P,MAAL,CAAY+T,UAAZ,CAAuB,KAAKN,aAA5B;AACD;AACF;;;sCAEiB;AAChB,WAAKjG,UAAL,CAAgBzG,SAAhB,CAA0B9E,MAA1B,CAAiC,SAAjC,EADgB,CAGhB;;AACA,UAAM+R,eAAe,GAAG,KAAKC,iBAAL,IACnB,KAAKpG,QAAL,CAAcC,MAAd,CAAqB3C,qBAArB,GAA6C+I,MADlD;AAEA,WAAKD,iBAAL,GAAyB,IAAzB;AAEA,WAAK1G,MAAL,CAAY4G,KAAZ,CAAkBD,MAAlB,aAA8BF,eAA9B;AACD;;;gDAE2B;AAAA;;AAC1B,UAAI,KAAK5M,QAAL,CAAcgN,kBAAd,KAAqC,MAAzC,EAAiD;AAC/C,YAAI,KAAK9G,WAAT,EAAsB;AACpB,cAAI7D,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,CAAJ,EAA+C;AAC7C,iBAAK/G,EAAL,CAAQ0F,OAAR,CAAgBgM,oBAAhB,GAAuC,MAAvC;AACD,WAFD,MAEO;AACL,iBAAKJ,iBAAL,GAAyB,KAAKpG,QAAL,CAAcC,MAAd,CAAqB3C,qBAArB,GAA6C+I,MAAtE;AACA,iBAAKvR,EAAL,CAAQ0F,OAAR,CAAgBgM,oBAAhB,GAAuC,QAAvC;AACD;AACF,SAR8C,CAU/C;AACA;AACA;AACA;;;AACA,YAAI5K,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,KACED,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,EAAoC,IAApC,KAA6C,CAAC,KAAK4D,WADzD,EACuE;AACrE,cAAI,KAAK3K,EAAL,CAAQ2R,UAAR,KAAuB,KAAK9G,UAAhC,EAA4C;AAC1C,gBAAM+G,YAAY,GAAG9U,QAAQ,CAAC+U,aAA9B;AACA,iBAAK7R,EAAL,CAAQ8R,YAAR,CAAqB,KAAKjH,UAA1B,EAAsC,KAAKD,MAA3C;AACAgH,wBAAY,CAAC/H,KAAb,GAH0C,CAGpB;AACvB,WALoE,CAOrE;AACA;;;AACAvF,oBAAU,CAAC,YAAM;AACf,gBAAMyN,cAAc,GAAG,MAAI,CAACzM,UAAL,CAAgB,CAAhB,EAAmBkD,qBAAnB,EAAvB;;AACA,gBAAMwJ,UAAU,GAAG,MAAI,CAAC1M,UAAL,CAAgB,CAAhB,EAAmB2M,YAAnB,IACdrV,MAAM,CAACsV,gBAAP,CAAwB,MAAI,CAAC5M,UAAL,CAAgB,CAAhB,CAAxB,CADL;AAEA,gBAAM6M,WAAW,GAAIhE,QAAQ,CAAC6D,UAAU,CAACI,UAAZ,EAAwB,EAAxB,CAAT,GAAwC,CAA5D;AACA,gBAAMC,OAAO,GAAGC,KAAK,CAACC,SAAN,CAAgBC,IAAhB,CAAqBC,IAArB,CAA0B,MAAI,CAACnN,UAA/B,EACd,UAAAE,KAAK;AAAA,qBAAIA,KAAK,CAACgD,qBAAN,GAA8BE,IAA9B,GAAqCqJ,cAAc,CAACrJ,IAAxD;AAAA,aADS,CAAhB;;AAEA,gBAAI2J,OAAJ,EAAa;AACX,oBAAI,CAACxH,UAAL,CAAgB2G,KAAhB,CAAsB5I,KAAtB,aAAiC,CAACmJ,cAAc,CAACnJ,KAAf,GAAuBuJ,WAAxB,IAAuC,CAAxE;AACA,oBAAI,CAACtH,UAAL,CAAgB2G,KAAhB,CAAsBkB,QAAtB,aAAoC,CAACX,cAAc,CAACnJ,KAAf,GAAuBuJ,WAAxB,IAAuC,CAA3E;AACD;;AACD,kBAAI,CAAC/F,eAAL;AACD,WAZS,EAYP,KAAKzB,WAAL,GAAmB,GAAnB,GAAyB,GAZlB,CAAV;AAaD,SAvBD,MAuBO;AACL,cAAI,KAAK3K,EAAL,CAAQ2S,iBAAR,KAA8B,KAAK9H,UAAvC,EAAmD;AACjD,iBAAK7K,EAAL,CAAQ8F,WAAR,CAAoB,KAAK+E,UAAzB;AACD;;AACD,eAAKA,UAAL,CAAgB2G,KAAhB,CAAsB5I,KAAtB,GAA8B,EAA9B;AACA,eAAKiC,UAAL,CAAgB2G,KAAhB,CAAsBkB,QAAtB,GAAiC,EAAjC;;AACA,eAAKtG,eAAL;AACD;;AAED,YAAItF,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,eAAK2K,8BAAL;AACD;AACF,OAjDD,MAiDO;AACL,aAAKxG,eAAL;;AACA,aAAKwG,8BAAL;AACD;AACF;;;qDAEgC;AAC/B;AACA;AACA,UAAI9L,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC,YAAMkC,WAAW,GAAG,KAAKe,QAAL,CAAcE,SAAd,CAAwB5C,qBAAxB,EAApB;AACA,YAAM4B,kBAAkB,GAAG,KAAKU,WAAL,CAAiBtC,qBAAjB,EAA3B;;AAEA,YAAI,KAAK0C,QAAL,CAAcE,SAAd,CAAwBd,UAAxB,GAAqCH,WAAW,CAACvB,KAAjD,GAAyD,EAAzD,GACA,KAAKkC,WAAL,CAAiBT,UADjB,GAC8BD,kBAAkB,CAACxB,KADrD,EAC4D;AAC1D,eAAKkC,WAAL,CAAiBT,UAAjB,GAA8B,KAAKa,QAAL,CAAcE,SAAd,CAAwBd,UAAxB,GAC1BH,WAAW,CAACvB,KADc,GACNwB,kBAAkB,CAACxB,KADb,GACqB,EADnD;AAED,SAJD,MAIO,IAAI,KAAKsC,QAAL,CAAcE,SAAd,CAAwBd,UAAxB,GAAqC,KAAKQ,WAAL,CAAiBT,UAA1D,EAAsE;AAC3E,eAAKS,WAAL,CAAiBT,UAAjB,GAA8B,KAAKa,QAAL,CAAcE,SAAd,CAAwBd,UAAxB,GAAqC,EAAnE;AACD;AACF;AACF;;;oDAE+B;AAC9B,UAAIxD,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,CAAJ,EAAsC;AACpC;AACA;AACA,YAAI,KAAK6C,WAAL,CAAiBT,UAAjB,GAA8B,CAAlC,EAAqC;AACnC,eAAKU,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqCC,GAArC,CAAyC,SAAzC;AACD,SAFD,MAEO;AACL,eAAK0G,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqC9E,MAArC,CAA4C,SAA5C;AACD;;AAED,YAAI,KAAKwL,WAAL,CAAiBT,UAAjB,GAA8B,KAAKS,WAAL,CAAiBP,WAAjB,GAC9B,KAAKO,WAAL,CAAiBN,WADrB,EACkC;AAChC,eAAKO,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqCC,GAArC,CAAyC,SAAzC;AACD,SAHD,MAGO;AACL,eAAK0G,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqC9E,MAArC,CAA4C,SAA5C;AACD;AACF,OAfD,MAeO;AACL,aAAKyL,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqC9E,MAArC,CAA4C,SAA5C;AACA,aAAKyL,kBAAL,CAAwB,CAAxB,EAA2B3G,SAA3B,CAAqC9E,MAArC,CAA4C,SAA5C;AACD;AACF;;;yCAEoBmL,W,EAAa;AAChC,UAAIA,WAAJ,EAAiB;AACf,aAAKK,WAAL,CAAiBT,UAAjB,GAA8B,KAAKS,WAAL,CAAiBT,UAAjB,GAA8B,GAA5D;AACD,OAFD,MAEO;AACL,aAAKS,WAAL,CAAiBT,UAAjB,GAA8B,KAAKS,WAAL,CAAiBT,UAAjB,GAA8B,GAA5D;AACD;AACF;;;sCAEiB;AAChB,UAAI,KAAKwI,SAAT,EAAoB;AAClB,aAAKA,SAAL,CAAe/P,MAAf;AACA,aAAK+P,SAAL,GAAiB,IAAjB;AACD;AACF;;;qCAEgB;AAAA;;AACf,UAAI,KAAK3H,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6BC,SAA7B,KAA2C,OAA3C,IACEmB,yBAAM,CAACC,uBAAP,CAA+B,GAA/B,KAAuC,KAAKtC,QAAL,CAAcuD,aAAd,KAAgC,QADzE,IAEElB,yBAAM,CAACmB,oBAAP,CAA4B,GAA5B,KAAoC,KAAKxD,QAAL,CAAcuD,aAAd,KAAgC,SAF1E,EAGE;;AAEF,UAAI,KAAKmJ,MAAT,EAAiB;AACf,aAAKA,MAAL,GAAc,KAAd;AACA;AACD;;AAED,WAAKnE,eAAL;;AAEA,WAAK6F,SAAL,GAAiB,IAAIC,qCAAJ,CAAuB;AACtCrO,gBAAQ,EAAE,KAAKA,QADuB;AAEtCC,cAAM,EAAE,KAAKsG,OAFyB;AAGtCrG,0BAAkB,EAAE,KAAKW,UAHa;AAItCV,kBAAU,EAAEuJ,QAAQ,CAAC,KAAKjD,QAAL,CAAcC,MAAd,CAAqBzF,OAArB,CAA6BgI,YAA9B,EAA4C,EAA5C,CAJkB;AAKtC7I,0BAAkB,EAAE,4BAAArG,KAAK;AAAA,iBAAI,MAAI,CAAC6P,mBAAL,CAAyB7P,KAAzB,CAAJ;AAAA;AALa,OAAvB,CAAjB;AAOD;;;;;;;;;;;;;;AC1jBH;AACA;AACA;AACA;AACA;;IAEqBuU,6B;AACnB,0BAAY3P,OAAZ,EAAqB;AAAA;;AACnB,SAAK1G,OAAL,GAAeC,gBAAC,CAACC,MAAD,CAAhB;AACA,SAAKoW,SAAL,GAAiB5P,OAAO,CAAC4P,SAAzB;AACA,SAAKC,QAAL,GAAgB7P,OAAO,CAAC6P,QAAxB;AACA,SAAKC,OAAL,GAAe9P,OAAO,CAAC8P,OAAvB;AACA,SAAKzO,QAAL,GAAgBrB,OAAO,CAACqB,QAAxB;AACA,SAAK0O,OAAL,GAAe/P,OAAO,CAAC+P,OAAvB;AACA,SAAKC,UAAL,GAAkBhQ,OAAO,CAACgQ,UAA1B;AACA,SAAKC,SAAL,GAAiBjQ,OAAO,CAACiQ,SAAzB;AACA,SAAKC,cAAL,GAAsBlQ,OAAO,CAACkQ,cAAR,IAA0B,IAAhD;AAEA,SAAKC,aAAL,GAAqB,IAArB;AAEA,SAAKC,YAAL,GAAoBpQ,OAAO,CAACoQ,YAA5B,CAbmB,CAenB;;AACA,SAAKC,KAAL,GAAa,KAAKT,SAAL,CAAe/U,IAAf,CAAoB,qBAApB,CAAb;AACA,SAAKyV,iBAAL,GAAyB,KAAKV,SAAL,CAAe/U,IAAf,CAAoB,oBAApB,CAAzB;AACA,SAAK0V,gBAAL,GAAwB,KAAKF,KAAL,CAAWxV,IAAX,CAAgB,iBAAhB,CAAxB;AACA,SAAK2V,eAAL,GAAuB,KAAKH,KAAL,CAAWxV,IAAX,CAAgB,uBAAhB,CAAvB;AACA,SAAK4V,WAAL,GAAmB,KAAKb,SAAL,CAAe,CAAf,EAAkB5V,aAAlB,CAAgC,6BAAhC,CAAnB;;AACA,QAAI,KAAKyW,WAAT,EAAsB;AACpB,WAAKC,eAAL,GAAuB,KAAKD,WAAL,CAAiBvQ,YAAjB,CAA8B,MAA9B,CAAvB;AACD;;AAED,SAAKyQ,aAAL,GAAqB;AACnBC,YAAM,EAAE,KAAKf,QAAL,CAAchV,IAAd,CAAmB,cAAnB,CADW;AAEnBgW,iBAAW,EAAE,KAAKhB,QAAL,CAAchV,IAAd,CAAmB,qBAAnB,CAFM;AAGnBiW,qBAAe,EAAE,KAAKjB,QAAL,CAAchV,IAAd,CAAmB,yBAAnB,CAHE;AAInBkW,0BAAoB,EAAE,KAAKlB,QAAL,CAAchV,IAAd,CAAmB,gCAAnB,CAJH;AAKnBmW,YAAM,EAAE,KAAKnB,QAAL,CAAchV,IAAd,CAAmB,oBAAnB,CALW;AAMnBoW,sBAAgB,EAAE,KAAKpB,QAAL,CAAchV,IAAd,CAAmB,0BAAnB,CANC;AAOnBqW,wBAAkB,EAAE,KAAKrB,QAAL,CAAchV,IAAd,CAAmB,4BAAnB,CAPD;AAQnBsW,UAAI,EAAE,KAAKtB,QAAL,CAAchV,IAAd,CAAmB,oBAAnB;AARa,KAArB;AAWA,SAAKuW,KAAL,GAAa,IAAIC,wBAAJ,CAAU,KAAKhB,KAAf,CAAb;;AAEA,QAAI,KAAKN,OAAL,IAAgB,KAAKA,OAAL,CAAazE,KAAb,CAAmBjP,MAAvC,EAA+C;AAC7C,WAAKiV,OAAL,GAAe,IAAIhK,6BAAJ,CAAmB;AAChC1K,UAAE,EAAEoD,OAAO,CAACsR,OADoB;AAEhCjQ,gBAAQ,EAAE,KAAKA,QAFiB;AAGhCkG,mBAAW,EAAEvH,OAAO,CAACuH;AAHW,OAAnB,CAAf;AAKD;;AAED,SAAKvM,WAAL;;AACA,SAAKuW,YAAL;AACD;;;;6BAEQ;AACP,WAAKlB,KAAL,CAAW9V,GAAX,4BAAmC,KAAK0V,SAAxC;AACA,WAAK3W,OAAL,CAAaiB,GAAb,4BAAqC,KAAK0V,SAA1C;AACA,WAAKmB,KAAL,CAAW1R,MAAX;;AAEA,UAAI,KAAKyQ,aAAT,EAAwB;AACtB,aAAKA,aAAL,CAAmBzQ,MAAnB;AACD;;AAED,UAAI,KAAK4R,OAAT,EAAkB;AAChB,aAAKA,OAAL,CAAa5R,MAAb;AACD;AACF;;;kCAEa;AAAA;;AACZ,WAAKpG,OAAL,CAAaY,EAAb,2DAAmE,KAAK+V,SAAxE,GAAqF,UAAC9V,KAAD,EAAQ2E,IAAR;AAAA,eAAiB,KAAI,CAAC0S,cAAL,CAAoBrX,KAApB,EAA2B2E,IAA3B,CAAjB;AAAA,OAArF;AACA,WAAKuR,KAAL,CAAWnW,EAAX,kCAAwC,KAAK+V,SAA7C,GAA0D,UAAA9V,KAAK;AAAA,eAAI,KAAI,CAACsX,gBAAL,CAAsBtX,KAAtB,CAAJ;AAAA,OAA/D;AACD;;;mCAEc;AACb,UAAI,CAAC,KAAKoW,gBAAL,CAAsBlU,MAA3B,EAAmC;AAEnC,WAAK8T,aAAL,GAAqB,IAAIuB,sCAAJ,CACnB,KAAK3B,OADc,EAEnB,KAAKQ,gBAFc,EAGnB,KAAKC,eAHc,EAInB;AAAEmB,qBAAa,EAAE;AAAjB,OAJmB,CAArB;AAOA,WAAKxB,aAAL,CAAmByB,aAAnB,CAAiC,KAAK1B,cAAtC;AACD;;;mCAEc/V,K,EAAO2E,I,EAAM;AAC1B,UAAIA,IAAI,CAACiR,OAAL,KAAiB,KAAKA,OAA1B,EAAmC;AADT,UAIxBvG,OAJwB,GAMtB1K,IANsB,CAIxB0K,OAJwB;AAAA,UAKxBqI,SALwB,GAMtB/S,IANsB,CAKxB+S,SALwB;;AAQ1B,UAAIA,SAAJ,EAAe;AACb;AACD,OAVyB,CAY1B;;;AACA,WAAKtB,gBAAL,CAAsBuB,GAAtB,CAA0BhT,IAAI,CAAC0K,OAAL,CAAaxM,EAAvC;AACA,WAAKsU,OAAL,CAAaS,oBAAb,CAAkCvI,OAAlC,EAd0B,CAgB1B;;AACA,WAAKwI,YAAL,CAAkBxI,OAAlB;;AACA,WAAKyI,UAAL,CAAgBzI,OAAhB;;AACA,WAAK0I,YAAL,CAAkB1I,OAAlB;;AACA,WAAK2I,aAAL,CAAmB3I,OAAnB;;AACA,WAAK4I,kBAAL,CAAwB5I,OAAxB;;AACA,WAAK6I,sBAAL,CAA4B7I,OAA5B;;AAEA,UAAI,KAAKwG,UAAT,EAAqB;AACnB,YAAMsC,GAAG,aAAM,KAAKvC,OAAL,CAAawC,MAAnB,cAA6BhZ,gBAAC,CAACiZ,KAAF,CAAQ;AAAEhJ,iBAAO,EAAEA,OAAO,CAACxM;AAAnB,SAAR,CAA7B,CAAT;AACAwH,eAAO,CAACiO,YAAR,CAAqB,EAArB,EAAyB,SAAzB,EAAoCH,GAApC;AACD;AACF;;;iCAEY9I,O,EAAS;AACpB;AACA,UAAMkJ,eAAe,GACnB,CAAC,CAAClJ,OAAO,CAACmJ,gBAAV,IAA8BnJ,OAAO,CAACmJ,gBAAR,GAA2BnJ,OAAO,CAACoJ,KADnE;AAGA,WAAKjC,aAAL,CAAmBG,eAAnB,CAAmC+B,WAAnC,CAA+C,SAA/C,EAA0DH,eAA1D;AACA,WAAK/B,aAAL,CAAmBI,oBAAnB,CAAwC+B,IAAxC,CACEhK,OAAO,CAACiK,WAAR,CAAoBvJ,OAAO,CAACmJ,gBAA5B,EAA8C,KAAKtR,QAAL,CAAc2R,YAA5D,CADF,EANoB,CAUpB;;AACA,WAAKrC,aAAL,CAAmBE,WAAnB,CAA+BiC,IAA/B,CACEhK,OAAO,CAACiK,WAAR,CAAoBvJ,OAAO,CAACoJ,KAA5B,EAAmC,KAAKvR,QAAL,CAAc2R,YAAjD,CADF;AAGD;;;+BAEUxJ,O,EAAS;AAClB,UAAIA,OAAO,CAACyJ,GAAR,KAAgB,EAApB,EAAwB;AACtB,aAAKtC,aAAL,CAAmBQ,IAAnB,CAAwB+B,MAAxB,GAAiCtY,QAAjC,CAA0C,oBAA1C;AACD,OAFD,MAEO;AACL,aAAK+V,aAAL,CAAmBQ,IAAnB,CAAwB+B,MAAxB,GAAiCrX,WAAjC,CAA6C,oBAA7C;AACD;;AAED,WAAK8U,aAAL,CAAmBQ,IAAnB,CAAwB2B,IAAxB,CAA6BtJ,OAAO,CAACyJ,GAArC;AACD;;;iCAEYzJ,O,EAAS;AACpB,UAAM2J,UAAU,GAAG3J,OAAO,CAACmJ,gBAAR,GAA2BnJ,OAAO,CAACmJ,gBAAR,GAA2BnJ,OAAO,CAACoJ,KAA9D,GAAsE,CAAzF;AACA,WAAKjC,aAAL,CAAmBK,MAAnB,CAA0BoC,MAA1B,CAAiC,CAAC,CAACD,UAAnC;;AAEA,UAAI,KAAKxC,aAAL,CAAmBM,gBAAnB,CAAoC5U,MAAxC,EAAgD;AAC9C;AACA,aAAKsU,aAAL,CAAmBM,gBAAnB,CAAoC6B,IAApC,CACEhK,OAAO,CAACiK,WAAR,CAAoBI,UAApB,EAAgC,KAAK9R,QAAL,CAAc2R,YAA9C,CADF;AAGD;;AAED,UAAI,KAAKrC,aAAL,CAAmBO,kBAAnB,CAAsC7U,MAA1C,EAAkD;AAChD;AACA,YAAMgX,eAAe,GAAGC,IAAI,CAACC,KAAL,CAAYJ,UAAU,GAAG,GAAd,GAAqB3J,OAAO,CAACmJ,gBAAxC,CAAxB;AACA,aAAKhC,aAAL,CAAmBO,kBAAnB,CAAsC4B,IAAtC,CAA2CO,eAA3C;AACD;AACF;;;kCAEa7J,O,EAAS;AACrB,UAAIA,OAAO,CAACgK,SAAZ,EAAuB;AACrB,aAAKlD,iBAAL,CAAuBwC,IAAvB,CAA4B,KAAKhD,OAAL,CAAa2D,iBAAzC;AACA,aAAKnD,iBAAL,CACGzU,WADH,CACe,UADf,EAEG6X,IAFH,CAEQ,UAFR,EAEoB,KAFpB;AAGD,OALD,MAKO;AACL,aAAKpD,iBAAL,CAAuBwC,IAAvB,CAA4B,KAAKhD,OAAL,CAAa6D,mBAAzC;AACA,aAAKrD,iBAAL,CACG1V,QADH,CACY,UADZ,EAEG8Y,IAFH,CAEQ,UAFR,EAEoB,IAFpB;AAGD;AACF;;;uCAEkBlK,O,EAAS;AAC1B,UAAI,KAAKnI,QAAL,CAAcuS,eAAlB,EAAmC;AACjC,YAAMC,WAAW,GAAG,KAAKxD,KAAL,CAAW,CAAX,EAAcrW,aAAd,CAA4B,4BAA5B,CAApB;;AACA,YAAI6Z,WAAJ,EAAiB;AACfA,qBAAW,CAACC,SAAZ,GAAwBtK,OAAO,CAACxJ,OAAR,CAAgB+K,QAAQ,CAAC8I,WAAW,CAACvR,OAAZ,CAAoByR,iBAArB,EAAwC,EAAxC,CAAxB,CAAxB;AACD;AACF;AACF;;;2CAEsBvK,O,EAAS;AAC9B,UAAI,KAAKiH,WAAT,EAAsB;AACpB,aAAKA,WAAL,CAAiBrF,YAAjB,CAA8B,MAA9B,YAAyC,KAAKsF,eAA9C,sBAAyElH,OAAO,CAACxM,EAAjF;AACD;AACF;;;qCAEgB7C,K,EAAO;AACtBA,WAAK,CAACqB,cAAN;AAEA,UAAMwY,QAAQ,GAAG,KAAK3D,KAAL,CAAW4D,cAAX,EAAjB;AAEA,UAAMjU,OAAO,GAAG;AACdkU,kBAAU,EAAE,KAAK5D,iBADH;AAEdjP,gBAAQ,EAAE;AACR8S,qBAAW,EAAE,KAAK9S,QAAL,CAAc2R,YADnB;AAERoB,yBAAe,EAAE,KAAK/S,QAAL,CAAcgT;AAFvB;AAFI,OAAhB;AAQAC,wCAAe,CAACzN,IAAhB,CAAqBmN,QAArB,EAA+BhU,OAA/B,EAAwC,KAAKoQ,YAA7C;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IC9MkBmE,M;;;;;;;;AACnB;;;;;;4BAMQC,M,EAAQC,I,EAAM;AACpB,UAAIC,UAAU,GAAGF,MAAjB;;AACA,UAAI,OAAOA,MAAP,KAAkB,QAAtB,EAAgC;AAC9BE,kBAAU,GAAG,CAACF,MAAD,CAAb;AACD;;AAED,WAAK,IAAI9K,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgL,UAAU,CAACrY,MAA/B,EAAuCqN,CAAC,EAAxC,EAA4C;AAC1C,aAAKiL,SAAL,CAAe,KAAKC,gBAAL,CAAsBF,UAAU,CAAChL,CAAD,CAAhC,EAAqC+K,IAArC,CAAf;AACD;AACF;AAED;;;;;;;;8BAKUI,I,EAAM;AACd,UAAMC,KAAK,GAAG,IAAIC,KAAJ,EAAd;AACAD,WAAK,CAAC5R,GAAN,GAAY2R,IAAZ;AACA,aAAOC,KAAP;AACD;AAED;;;;;;;;;;uCAOmC;AAAA,UAAlB5R,GAAkB,uEAAZ,IAAY;AAAA,UAANuR,IAAM;;AACjC,UAAI,CAACA,IAAL,EAAW;AACT,eAAO,IAAP;AACD;;AAED,UAAIA,IAAI,KAAK,QAAb,EAAuB;AACrB,eAAO,KAAKO,cAAL,CAAoB9R,GAApB,CAAP;AACD;;AAED,UAAMjG,KAAK,GAAGiG,GAAG,CAACjG,KAAJ,CAAU,sDAAV,CAAd;;AAEA,UAAIA,KAAJ,EAAW;AACT,YAAMgY,MAAM,GAAG/R,GAAG,CAAC/D,KAAJ,CAAUlC,KAAK,CAAC,CAAD,CAAf,CAAf;AACA,YAAMiY,MAAM,GAAGjY,KAAK,CAAC,CAAD,CAApB;AAEA,eAAO,KAAK+X,cAAL,WAAuBC,MAAM,CAAC,CAAD,CAA7B,cAAoCR,IAApC,SAA2CS,MAA3C,EAAP;AACD;;AAEDC,aAAO,CAACC,IAAR,cAAmBX,IAAnB,yBAAsCvR,GAAtC;AACA,aAAO,IAAP;AACD;;;mCAEc2R,I,EAAM;AACnB,aAAOA,IAAI,CAACQ,OAAL,CAAa,WAAb,EAA0B,EAA1B,CAAP;AACD;;;;;;;;;;;;;;AC5DH;AACA;AAKA;AACA;;IAEMf,+B;AACJ,6BAAc;AAAA;;AACZ,SAAKN,QAAL,GAAgB,EAAhB;AACA,SAAK3S,QAAL,GAAgB,EAAhB;AACA,SAAKpH,MAAL,GAAc,EAAd;AACA,SAAKsa,MAAL,GAAc,IAAIA,MAAJ,EAAd;AACA,SAAKe,cAAL,GAAsB,mBAAtB;AACA,SAAKC,YAAL,GAAoBhc,gBAAC,4BAAqB,KAAK+b,cAA1B,EAArB;AACA,SAAK7G,aAAL,GAAqB,IAArB;AACA,SAAK+G,MAAL,GAAc,IAAd;AAEA,SAAKC,SAAL,GAAiB/b,QAAQ,CAACM,aAAT,CAAuB,KAAKsb,cAA5B,CAAjB;AAEA,SAAKI,OAAL,GAAe,KAAKA,OAAL,CAAatY,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKuY,QAAL,GAAgB,KAAKA,QAAL,CAAcvY,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKwY,UAAL,GAAkB,KAAKA,UAAL,CAAgBxY,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKyY,WAAL,GAAmB,KAAKA,WAAL,CAAiBzY,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKhD,oBAAL,GAA4B,KAAKA,oBAAL,CAA0BgD,IAA1B,CAA+B,IAA/B,CAA5B;AAEA,SAAK9C,SAAL,GAAiB,KAAKA,SAAL,CAAe8C,IAAf,CAAoB,IAApB,CAAjB;AAEA,SAAK0Y,aAAL,GAAqB,IAAIzc,gCAAJ,EAArB;AAEA,SAAKU,MAAL,GAAcL,QAAQ,CAACM,aAAT,CAAuB,oBAAvB,CAAd;AACA,SAAK+b,kBAAL,GAA0Brc,QAAQ,CAACM,aAAT,CAAuB,iCAAvB,CAA1B;AACA,SAAKgc,OAAL,GAAezc,gBAAC,CAAC,KAAKQ,MAAN,CAAhB;AACA,SAAKJ,KAAL,GAAaJ,gBAAC,CAACG,QAAQ,CAACE,IAAV,CAAd;AACD;;;;yBAEIoa,Q,EAAUhU,O,EAAyB;AAAA,UAAhBiW,SAAgB,uEAAJ,EAAI;AACtC,WAAKjC,QAAL,GAAgBA,QAAhB,CADsC,CAGtC;;AACA,WAAKiC,SAAL,GAAiB1c,gBAAC,CAAC2c,MAAF,CAAS;AACxBC,cAAM,EAAE,KAAKT,OADW;AAExBU,eAAO,EAAE,KAAKT,QAFU;AAGxBU,iBAAS,EAAE,KAAKT,UAHQ;AAIxBU,eAAO,EAAE,KAAKT;AAJU,OAAT,EAKdI,SALc,CAAjB;AAJsC,UAW9B/B,UAX8B,GAWflU,OAXe,CAW9BkU,UAX8B;AAatC,WAAK7S,QAAL,GAAgB9H,gBAAC,CAAC2c,MAAF,CAAS;AACvB/B,mBAAW,EAAE,IADU;AAEvBC,uBAAe,EAAE;AAFM,OAAT,EAGbpU,OAAO,CAACqB,QAHK,CAAhB,CAbsC,CAkBtC;;AACA,WAAKkV,aAAL;;AAEA,WAAKN,SAAL,CAAeE,MAAf;AAEA,WAAK1H,aAAL,GAAqB/U,QAAQ,CAAC+U,aAA9B;;AAEA,WAAK+H,cAAL,CAAoBtC,UAApB;;AACA,WAAKuC,WAAL,CAAiBvC,UAAjB;AACD;;;6BAEQ;AACP,WAAK4B,aAAL,CAAmBna,cAAnB;;AACA,WAAK+a,cAAL;;AACA,aAAO,KAAKnC,MAAZ;AACD;;;gCAEWL,U,EAAY;AAAA;;AACtB,UAAMyC,OAAO,GAAG,KAAKpB,YAAL,CAAkB5a,KAAlB,EAAhB;AAEA,UAAMic,aAAa,GAAG,KAAK5C,QAAL,CAAc6C,MAAd,CAAqB,UAAA/X,IAAI;AAAA,eAAIA,IAAI,CAAC0J,IAAL,KAAc,UAAlB;AAAA,OAAzB,CAAtB;AACA,UAAMsO,QAAQ,GAAGF,aAAa,CAAC,CAAD,CAAb,CAAiBG,KAAlC;AAEAxd,sBAAC,CAACyd,IAAF,CAAO;AACLvc,YAAI,EAAE,MADD;AAEL6X,WAAG,YAAK9Y,MAAM,CAACyd,KAAP,CAAaC,MAAb,CAAoBC,YAAzB,QAFE;AAGLrY,YAAI,EAAEvF,gBAAC,CAACiZ,KAAF,CAAQ,KAAKwB,QAAb,CAHD;AAILoD,gBAAQ,EAAE;AAJL,OAAP,EAMGC,IANH,CAMQ,UAAAC,QAAQ,EAAI;AAChB,aAAI,CAAC9B,MAAL,GAAc8B,QAAQ,CAACta,EAAvB;;AAEA,YAAIsa,QAAQ,CAACxC,KAAb,EAAoB;AAClB,cAAMyC,QAAQ,GAAG,KAAI,CAAChD,MAAL,CAAYK,gBAAZ,CAA6B0C,QAAQ,CAACxC,KAAtC,EAA6C,MAA7C,CAAjB;;AACA,eAAI,CAACP,MAAL,CAAYI,SAAZ,CAAsB4C,QAAtB;;AAEAZ,iBAAO,CAAC9b,IAAR,CAAa,iCAAb,EACGC,IADH,sBACqByc,QADrB,sBACuCD,QAAQ,CAACE,aADhD;AAED;;AAEDb,eAAO,CAAC9b,IAAR,CAAa,iCAAb,EACGiY,IADH,CACQwE,QAAQ,CAACE,aADjB;AAGA;;;;;AAIA,YAAIF,QAAQ,CAACG,eAAT,CAAyB,CAAzB,MAAgC,OAAhC,IAA2CH,QAAQ,CAACG,eAAT,CAAyB,CAAzB,MAAgC,eAA/E,EAAgG;AAC9Fd,iBAAO,CAAC9b,IAAR,CAAa,mCAAb,EACGiY,IADH,CACQwE,QAAQ,CAACG,eAAT,CAAyBC,IAAzB,CAA8B,IAA9B,CADR;AAED;AAED;;;;;;AAIA,YAAMC,qBAAqB,GAAGhB,OAAO,CAAC9b,IAAR,CAAa,0CAAb,CAA9B;AACA8c,6BAAqB,CAAC7E,IAAtB,WAA8BgE,QAA9B;AAEAvd,wBAAC,CAACyd,IAAF,CAAO;AACLvc,cAAI,EAAE,KADD;AAEL6X,aAAG,YAAK9Y,MAAM,CAACyd,KAAP,CAAaC,MAAb,CAAoBU,QAAzB,QAFE;AAGLR,kBAAQ,EAAE;AAHL,SAAP,EAKGC,IALH,CAKQ,UAAAQ,cAAc,EAAI;AACtB,cAAI,KAAI,CAACxW,QAAL,CAAc+S,eAAlB,EAAmC;AACjC0D,oBAAQ,CAACC,IAAT,GAAgBve,MAAM,CAACyd,KAAP,CAAaC,MAAb,CAAoBU,QAApC;AACA;AACD;;AAED,eAAI,CAAC3B,SAAL,CAAeI,SAAf,GANsB,CAQtB;;;AACA,eAAI,CAACrC,QAAL,GAAgB,EAAhB;AAEA,cAAIgE,QAAQ,GAAG,IAAf;AACAH,wBAAc,CAACI,KAAf,CAAqBlc,OAArB,CAA6B,UAAAmc,IAAI,EAAI;AACnC,gBAAIA,IAAI,CAAClb,EAAL,KAAY,KAAI,CAACwY,MAArB,EAA6B;AAC3B,kBAAI,CAACwC,QAAL,EAAe;AACbA,wBAAQ,GAAGE,IAAX;AACD,eAFD,MAEO;AACL;AACA;AACA;AACA;AACAF,wBAAQ,CAACG,+BAAT,GAA2CH,QAAQ,CAChDG,+BADwC,CACRC,MADQ,CACDF,IAAI,CAACC,+BADJ,CAA3C;AAEAH,wBAAQ,CAACK,WAAT,GAAuBL,QAAQ,CAACK,WAAT,GAAuBH,IAAI,CAACG,WAA5B,GACnBL,QAAQ,CAACK,WADU,GAEnBH,IAAI,CAACG,WAFT;AAGAL,wBAAQ,CAAClB,QAAT,IAAqBoB,IAAI,CAACpB,QAA1B;AACD;AACF;AACF,WAjBD;AAmBA,cAAMwB,kBAAkB,GAAG3B,OAAO,CAAC9b,IAAR,CAAa,uCAAb,CAA3B;AACAyd,4BAAkB,CAACxF,IAAnB,CACEhK,OAAO,CAACiK,WAAR,CAAoBiF,QAAQ,CAACO,cAA7B,EAA6C,KAAI,CAAClX,QAAL,CAAc8S,WAA3D,CADF;AAIA,cAAMqE,uBAAuB,GAAG7B,OAAO,CAAC9b,IAAR,CAAa,4CAAb,CAAhC;;AACA,cAAImd,QAAQ,CAACK,WAAT,GAAuBL,QAAQ,CAACO,cAApC,EAAoD;AAClDC,mCAAuB,CAAC1F,IAAxB,CACEhK,OAAO,CAACiK,WAAR,CAAoBiF,QAAQ,CAACK,WAA7B,EAA0C,KAAI,CAAChX,QAAL,CAAc8S,WAAxD,CADF;AAIAqE,mCAAuB,CAACC,IAAxB;AACAH,8BAAkB,CAAC1d,QAAnB,CAA4B,gBAA5B;AACD,WAPD,MAOO;AACL4d,mCAAuB,CAACE,IAAxB;AACAJ,8BAAkB,CAACzc,WAAnB,CAA+B,gBAA/B;AACD;;AAED,cAAM8c,iBAAiB,GAAGhC,OAAO,CAAC9b,IAAR,CAAa,qCAAb,CAA1B;;AACA,cAAImd,QAAQ,CAACG,+BAAT,CAAyC9b,MAAzC,GAAkD,CAAtD,EAAyD;AACvD,gBAAMuc,oBAAoB,GAAGD,iBAAiB,CAACE,QAAlB,GAA6BC,KAA7B,EAA7B;AACAH,6BAAiB,CAACI,KAAlB;AAEAf,oBAAQ,CAACG,+BAAT,CAAyCpc,OAAzC,CAAiD,UAAAid,QAAQ,EAAI;AAC3D,kBAAMC,SAAS,GAAGL,oBAAoB,CAACje,KAArB,EAAlB;AACAse,uBAAS,CAACpe,IAAV,CAAe,iBAAf,EAAkCC,IAAlC,CAAuCke,QAAQ,CAACE,oBAAT,CAA8BC,KAArE;AACA,kBAAMC,OAAO,GAAGH,SAAS,CAACpe,IAAV,CAAe,kBAAf,CAAhB;AACAue,qBAAO,CAACte,IAAR,CAAake,QAAQ,CAACK,MAAtB;AACAV,+BAAiB,CAAC5d,MAAlB,CAAyBke,SAAzB;AACD,aAND;AAQAN,6BAAiB,CAACF,IAAlB;AACD,WAbD,MAaO;AACLE,6BAAiB,CAACD,IAAlB;AACD;;AAED,cAAMY,SAAS,GAAG3C,OAAO,CAAC9b,IAAR,CAAa,iCAAb,CAAlB;AACAye,mBAAS,CAACxG,IAAV,CACEhK,OAAO,CAACiK,WAAR,CAAoB8E,cAAc,CAAC0B,WAAnC,EAAgD,KAAI,CAAClY,QAAL,CAAc8S,WAA9D,CADF;AAIAwC,iBAAO,CACJ9b,IADH,CACQ,+BADR,EAEGA,IAFH,CAEQ,MAFR,EAEgBiY,IAFhB,CAEqB+E,cAAc,CAAC2B,UAFpC;;AAIA,eAAI,CAACxD,OAAL,CAAajb,MAAb,CAAoB4b,OAApB,EA5EsB,CA8EtB;;;AACApd,0BAAC,CAACC,MAAD,CAAD,CAAUigB,OAAV,CAAkB,kBAAlB,EAAsC;AAAEnC,oBAAQ,EAAEO;AAAZ,WAAtC;;AAEA,eAAI,CAAC7c,WAAL,CAAiB2b,OAAjB;;AACA,eAAI,CAAC+C,WAAL,CAAiB/C,OAAjB,EAA0BzC,UAA1B;AACD,SAxFH;AAyFD,OA7HH,EA8HGyF,IA9HH,CA8HQ,UAAArC,QAAQ,EAAI;AAChB,YAAIsC,SAAJ;;AACA,YAAI;AACF,cAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWzC,QAAQ,CAACuC,YAApB,CAArB;AACAD,mBAAS,GAAGC,YAAY,CAACG,WAAzB;AACD,SAHD,CAGE,OAAOC,KAAP,EAAc;AACdL,mBAAS,aAAMtC,QAAQ,CAAC4C,MAAf,cAAyB5C,QAAQ,CAAC6C,UAAlC,CAAT;;AACA,cAAI7C,QAAQ,CAAC4C,MAAT,KAAoB,GAAxB,EAA6B;AAC3BN,qBAAS,aAAMA,SAAN,qCAAT;AACD;AACF;;AAED,aAAI,CAACQ,aAAL,CAAmBlG,UAAnB;;AACA,aAAI,CAAC+B,SAAL,CAAeG,OAAf,CAAuBwD,SAAvB;AACD,OA5IH;AA6ID;;;6BAEQK,K,EAAO;AACd,WAAKnE,aAAL,CAAmBtb,OAAnB,CAA2Byf,KAA3B,EAAkC,OAAlC;AACD;;;8BAES;AACR,WAAKnE,aAAL,CAAmBna,cAAnB;AACD;;;iCAEY;AACX;;;;;AAMD;;;kCAEa;AACZ;;;;;AAMD;;;gCAEWgb,O,EAAS;AAAA;;AACnB,WAAK1c,MAAL,CAAYsB,IAAZ,CAAiB,CACfob,OAAO,CAACzc,EAAR,CAAW,kBAAX,EAA+B,yBAA/B,EAA0D,UAAAC,KAAK,EAAI;AACjEA,aAAK,CAACqB,cAAN;;AACA,cAAI,CAAC6e,YAAL,CAAkB1D,OAAlB;AACD,OAHD,CADe,EAKfpd,gBAAC,CAACG,QAAD,CAAD,CAAYQ,EAAZ,CAAe,yCAAf,EAA0D,KAAKE,oBAA/D,CALe,CAAjB;AAOD;AAED;;;;;;;;oCAKqC;AAAA;;AAAA,UAAvBkgB,cAAuB,uEAAN,IAAM;AACnC/gB,sBAAC,CAAC,KAAK+b,cAAN,CAAD,CAAuBuB,MAAvB,CAA8B,sBAA9B,EAAsD1b,IAAtD,CAA2D,UAACC,KAAD,EAAQwB,EAAR,EAAe;AACxE,YAAM+Z,OAAO,GAAGpd,gBAAC,CAACqD,EAAD,CAAjB;;AAEA,YAAI0d,cAAc,IAAI3D,OAAO,CAAC4D,EAAR,CAAWD,cAAX,CAAtB,EAAkD;AAChD;AACD;;AAED,cAAI,CAACD,YAAL,CAAkB1D,OAAlB,EAA2Bvb,KAA3B;AACD,OARD;;AAUA,UAAI,CAACkf,cAAL,EAAqB;AACnB,aAAKrE,SAAL,CAAeK,OAAf;AACD;;AAED9c,YAAM,CAAC2H,mBAAP,CAA2B,SAA3B,EAAsC,KAAK7G,SAA3C;AACD;;;gCAEWqc,O,EAASzC,U,EAAY;AAAA;;AAC/B;;;;AAIA,WAAKqC,aAAL,CAAmBI,OAAnB;;AAEAA,aAAO,CACJ/b,QADH,CACY,wBADZ,EAEGgB,GAFH,CAEO,OAFP,EAEgB,YAAM;AAClB+a,eAAO,CACJ9a,WADH,CACe,wBADf,EAEGjB,QAFH,CAEY,SAFZ,EAGGL,GAHH,CAGO,OAHP;AAKAoc,eAAO,CAAC6D,IAAR,CAAa,oBAAb,EAAmC,IAAnC;AAEA1T,+CAAS,CAAC6P,OAAO,CAAC,CAAD,CAAR,CAAT;AAEAnd,cAAM,CAACuH,gBAAP,CAAwB,SAAxB,EAAmC,MAAI,CAACzG,SAAxC;;AAEA,cAAI,CAAC8f,aAAL,CAAmBlG,UAAnB;AACD,OAfH;AAgBD;;;8BAESzY,C,EAAG;AACX,UAAIA,CAAC,CAACC,GAAF,KAAU,QAAd,EAAwB;AACtB,aAAK6a,aAAL;AACD;AACF;AAED;;;;;;;;;;mCAOwC;AAAA;;AAAA,UAA3BI,OAA2B,uEAAjB,IAAiB;AAAA,UAAXvb,KAAW,uEAAH,CAAG;;AACtC,UAAI,CAACub,OAAL,EAAc;AACZ;AACD;;AAEDA,aAAO,CACJ/b,QADH,CACY,yBADZ,EAEGgB,GAFH,CAEO,OAFP,EAEgB,YAAM;AAClB+a,eAAO,CACJ9a,WADH,CACe,iCADf,EAEGD,GAFH,CAEO,OAFP,EAEgB,YAAM;AAClB+a,iBAAO,CAACpc,GAAR,CAAY,OAAZ;;AACA,gBAAI,CAACkgB,aAAL,CAAmB9D,OAAnB,EAA4Bvb,KAA5B,EAFkB,CAIlB;AACA;;;AACA,cAAI,MAAI,CAACsf,wBAAL,IAAiC,qBAAqB,MAAI,CAACA,wBAAL,CAA8BpY,OAAxF,EAAiG;AAC/F,kBAAI,CAACoY,wBAAL,CAA8BjU,KAA9B;AACD,WAFD,MAEO,IAAI,MAAI,CAACgI,aAAT,EAAwB;AAC7B,kBAAI,CAACA,aAAL,CAAmBhI,KAAnB;AACD;;AAEDD,uDAAe,CAACmQ,OAAO,CAAC,CAAD,CAAR,CAAf;;AACA,gBAAI,CAACV,SAAL,CAAeK,OAAf;AACD,SAhBH;AAiBD,OApBH;AAqBD;;;qCAEgB;AAAA;;AACf/c,sBAAC,CAAC,KAAK+b,cAAN,CAAD,CAAuBuB,MAAvB,CAA8B,sBAA9B,EAAsD1b,IAAtD,CAA2D,UAACC,KAAD,EAAQwB,EAAR,EAAe;AACxE,cAAI,CAAC6d,aAAL,CAAmBlhB,gBAAC,CAACqD,EAAD,CAApB,EAA0BxB,KAA1B;AACD,OAFD;AAGD;AAED;;;;;;;;;;kCAOcub,O,EAASvb,K,EAAO;AAC5B,UAAI,KAAKnB,MAAL,CAAYmB,KAAZ,CAAJ,EAAwB;AACtB,aAAKnB,MAAL,CAAYmB,KAAZ,EAAmBW,OAAnB,CAA2B,UAAAC,GAAG;AAAA,iBAAIA,GAAG,CAACzB,GAAJ,CAAQ,aAAR,CAAJ;AAAA,SAA9B;AACA,aAAKN,MAAL,CAAYgC,MAAZ,CAAmBb,KAAnB,EAA0B,CAA1B;AACD;;AAED,UAAIub,OAAJ,EAAa;AACXA,eAAO,CAACza,MAAR;AACD;AACF;;;mCAEcgY,U,EAAY;AACzBA,gBAAU,CACPtZ,QADH,CACY,YADZ,EAEG8Y,IAFH,CAEQ,UAFR,EAEoB,IAFpB;AAGD;;;kCAEaQ,U,EAAY;AACxBA,gBAAU,CACPR,IADH,CACQ,UADR,EACoB,KADpB,EAEG7X,WAFH,CAEe,YAFf;AAGD;;;yCAEoB1B,K,EAAO;AAAA,UAClBE,MADkB,GACPF,KADO,CAClBE,MADkB;AAE1B,UAAM8B,OAAO,GAAG5C,gBAAC,CAACc,MAAD,CAAD,CAAU+B,OAAV,CAAkB,mBAAlB,CAAhB;;AAEA,UAAID,OAAO,CAACE,MAAZ,EAAoB;AAClB;AACD;;AAED,WAAKqe,wBAAL,GAAgCrgB,MAAhC;;AACA,WAAKkc,aAAL;AACD;;;;;;AAGY,8FAAIjC,+BAAJ,EAAf,E;;;;;;;;AC5YA;AAAA;AAAA;AAEA,IAAMqG,aAAa,GAAG,EAAtB;AACA,IAAIC,kBAAkB,GAAG,IAAzB;;AAEA,SAASC,cAAT,GAA0B;AACxB,SAAOrhB,MAAM,CACVsV,gBADI,CACapV,QAAQ,CAACuL,eADtB,EACuC,SADvC,EAEJ6V,gBAFI,CAEa,SAFb,EAGJzF,OAHI,CAGI,IAHJ,EAGU,EAHV,EAIJlW,KAJI,CAIE,GAJF,CAAP;AAKD;;AAED,SAAS4b,aAAT,GAAyB;AACvB,SAAOvhB,MAAM,CACVsV,gBADI,CACapV,QAAQ,CAACuL,eADtB,EACuC,QADvC,EAEJ6V,gBAFI,CAEa,SAFb,EAGJzF,OAHI,CAGI,IAHJ,EAGU,EAHV,CAAP;AAID;;AAED9b,6CAAC,CAACC,MAAD,CAAD,CAAUU,EAAV,CAAa,QAAb,EAAuB,UAAAC,KAAK,EAAI;AAC9B,MAAM6gB,iBAAiB,GAAGD,aAAa,EAAvC;;AAEA,MAAIH,kBAAkB,KAAKI,iBAA3B,EAA8C;AAC5CL,iBAAa,CAAC5e,OAAd,CAAsB,UAAAkf,YAAY,EAAI;AACpCA,kBAAY,CAAC9gB,KAAD,EAAQ;AAClB+gB,gBAAQ,EAAEN,kBADQ;AAElBO,eAAO,EAAEH;AAFS,OAAR,CAAZ;AAID,KALD;AAMD;;AAEDJ,oBAAkB,GAAGI,iBAArB;AACD,CAbD;;AAeA,SAASnW,oBAAT,CAA8BuW,UAA9B,EAA6D;AAAA,MAAnBC,SAAmB,uEAAP,KAAO;AAC3D,MAAMC,WAAW,GAAGT,cAAc,EAAlC;AACA,MAAMG,iBAAiB,GAAGD,aAAa,EAAvC;AACA,MAAMQ,UAAU,GAAGD,WAAW,CAACrY,OAAZ,CAAoB+X,iBAApB,IAAyCM,WAAW,CAACrY,OAAZ,CAAoBmY,UAApB,CAA5D;AAEA,SAAOC,SAAS,GAAGE,UAAU,IAAI,CAAjB,GAAqBA,UAAU,GAAG,CAAlD;AACD;;AAED,SAAS5X,uBAAT,CAAiCyX,UAAjC,EAAgE;AAAA,MAAnBC,SAAmB,uEAAP,KAAO;AAC9D,MAAMC,WAAW,GAAGT,cAAc,EAAlC;AACA,MAAMG,iBAAiB,GAAGD,aAAa,EAAvC;AACA,MAAMQ,UAAU,GAAGD,WAAW,CAACrY,OAAZ,CAAoB+X,iBAApB,IAAyCM,WAAW,CAACrY,OAAZ,CAAoBmY,UAApB,CAA5D;AAEA,SAAOC,SAAS,GAAGE,UAAU,IAAI,CAAjB,GAAqBA,UAAU,GAAG,CAAlD;AACD;;AAED,SAASC,YAAT,GAAsC;AACpC,MAAMR,iBAAiB,GAAGD,aAAa,EAAvC;;AADoC,oCAAbO,WAAa;AAAbA,eAAa;AAAA;;AAEpC,SAAOA,WAAW,CAAClM,IAAZ,CAAiB,UAAAgM,UAAU;AAAA,WAAIA,UAAU,KAAKJ,iBAAnB;AAAA,GAA3B,CAAP;AACD;;AAED,SAASS,kBAAT,CAA4BR,YAA5B,EAA0C;AACxC,MAAIN,aAAa,CAAC1X,OAAd,CAAsBgY,YAAtB,MAAwC,CAAC,CAA7C,EAAgD;AAC9CN,iBAAa,CAACpf,IAAd,CAAmB0f,YAAnB;AACD;AACF;;AAED,SAASS,mBAAT,CAA6BT,YAA7B,EAA2C;AACzC,MAAM7f,KAAK,GAAGuf,aAAa,CAAC1X,OAAd,CAAsBgY,YAAtB,CAAd;;AAEA,MAAI7f,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBuf,iBAAa,CAAC1e,MAAd,CAAqBb,KAArB,EAA4B,CAA5B;AACD;AACF;;AAEc;AACbyJ,sBAAoB,EAApBA,oBADa;AAEblB,yBAAuB,EAAvBA,uBAFa;AAGb6X,cAAY,EAAZA,YAHa;AAIbC,oBAAkB,EAAlBA,kBAJa;AAKbC,qBAAmB,EAAnBA;AALa,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;ICtEqBC,Q;AACnB,oBAAY/e,EAAZ,EAAgB;AAAA;;AACd,SAAKZ,GAAL,GAAWzC,CAAC,CAACqD,EAAD,CAAZ;AACA,SAAKgf,YAAL,GAAoB,KAAK5f,GAAL,CAASnB,IAAT,CAAc,wBAAd,CAApB;AACA,SAAKghB,MAAL,GAAc,KAAK7f,GAAL,CAASnB,IAAT,CAAc,uBAAd,CAAd;AACA,SAAKihB,aAAL,GAAqB,KAAK9f,GAAL,CAASnB,IAAT,CAAc,yBAAd,CAArB;AACA,SAAKkhB,OAAL,GAAe,KAAK/f,GAAL,CAASnB,IAAT,CAAc,wBAAd,CAAf;AAEA,SAAKmhB,YAAL,GAAoB,KAAKA,YAAL,CAAkB5e,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAK6e,WAAL,GAAmB,KAAKA,WAAL,CAAiB7e,IAAjB,CAAsB,IAAtB,CAAnB;AAEA,SAAK2e,OAAL,CAAa7hB,EAAb,CAAgB,iBAAhB,EAAmC,KAAK8hB,YAAxC;AACA,SAAKH,MAAL,CAAY3hB,EAAZ,CAAe,iBAAf,EAAkC,KAAK+hB,WAAvC;AACD;;;;6BAEQ;AACP,WAAKjgB,GAAL,CAASzB,GAAT,CAAa,WAAb;AACD;;;mCAEcJ,K,EAAO;AACpB,UAAM+hB,SAAS,GAAGnR,QAAQ,CAAC5Q,KAAK,CAAC+Q,aAAN,CAAoB6L,KAArB,EAA4B,EAA5B,CAA1B;AAEA,aAAOoF,KAAK,CAACD,SAAD,CAAL,GAAmB,CAAnB,GAAuBA,SAA9B;AACD;;;iCAEY/hB,K,EAAO;AAClB,UAAM4c,KAAK,GAAG,KAAKqF,cAAL,CAAoBjiB,KAApB,CAAd,CADkB,CAGlB;;;AACA,WAAK0hB,MAAL,CAAY/J,GAAZ,CAAgBiF,KAAhB,EAAuB0C,OAAvB,CAA+B,QAA/B,EAJkB,CAMlB;;AACA,UAAI1C,KAAK,IAAI,EAAb,EAAiB;AACf,aAAK6E,YAAL,CACG/f,WADH,CACe,QADf,EAEGjB,QAFH,CAEY,SAFZ;AAIA,aAAKihB,MAAL,CACGpV,KADH,GAEG4V,UAFH,CAEc,UAFd,EAGGrR,MAHH;AAKA,aAAK8Q,aAAL,CACGjgB,WADH,CACe,SADf,EAEGjB,QAFH,CAEY,QAFZ;AAIA,aAAKmhB,OAAL,CAAavB,IAAb,CAAkB,UAAlB,EAA8B,IAA9B;AACD;AACF;;;gCAEWrgB,K,EAAO;AACjB,WAAK0hB,MAAL,CAAY/J,GAAZ,CAAgB,KAAKsK,cAAL,CAAoBjiB,KAApB,CAAhB;AACD;;;;;;;;;;;;;;ACpDH;AACA;;IAEqBkX,W;AACnB,iBAAYzU,EAAZ,EAAgD;AAAA;;AAAA,QAAhC0f,QAAgC,uEAArB,mBAAqB;;AAAA;;AAC9C,SAAKtgB,GAAL,GAAWzC,gBAAC,CAACqD,EAAD,CAAZ;AACA,SAAK2f,WAAL,GAAmB,mBAAnB;AACA,SAAKC,aAAL,GAAqBF,QAArB;AAEA,SAAKG,aAAL,GAAqB,EAArB;AACA,SAAKC,gBAAL,GAAwB,KAAK1gB,GAAL,CAASnB,IAAT,CAAc,yBAAd,CAAxB;AAEA,SAAK8hB,aAAL,GAAqB,KAAKA,aAAL,CAAmBvf,IAAnB,CAAwB,IAAxB,CAArB;AACA,SAAKpB,GAAL,CAAS9B,EAAT,CAAY,aAAZ,EAA2B,KAAKsiB,aAAhC,EAA+C,KAAKG,aAApD;AACA,SAAK3gB,GAAL,CAAS9B,EAAT,CAAY,YAAZ,EAA0B,KAAKsiB,aAA/B,EAA8C,KAAKG,aAAnD;;AAEA,SAAKC,YAAL;;AAEA,QAAI,KAAKF,gBAAL,CAAsBrgB,MAA1B,EAAkC;AAChC,WAAKqgB,gBAAL,CAAsBvhB,IAAtB,CAA2B,UAACuO,CAAD,EAAI9M,EAAJ,EAAW;AACpC,aAAI,CAAC6f,aAAL,CAAmBlhB,IAAnB,CACE,IAAIogB,QAAJ,CAAa/e,EAAb,CADF;AAGD,OAJD;AAKD;AACF;;;;6BAEQ;AACP,WAAKZ,GAAL,CAASzB,GAAT,CAAa,QAAb;AAEA,WAAKkiB,aAAL,CAAmB1gB,OAAnB,CAA2B,UAAA8gB,YAAY,EAAI;AACzCA,oBAAY,CAACnd,MAAb;AACD,OAFD;AAGD;;;mCAEc;AAAA;;AACb,WAAK1D,GAAL,CAASnB,IAAT,CAAc,KAAK2hB,aAAnB,EAAkCrhB,IAAlC,CAAuC,UAACuO,CAAD,EAAI9M,EAAJ,EAAW;AAChD,YAAIrD,gBAAC,CAACqD,EAAD,CAAD,CAAMkgB,QAAN,CAAe,MAAI,CAACP,WAApB,CAAJ,EAAsC;;AAEtC,cAAI,CAACI,aAAL,CAAmB,IAAnB,EAAyB/f,EAAzB;AACD,OAJD;AAKD;;;oCAEuC;AAAA,UAA1BzC,KAA0B,uEAAlB,IAAkB;AAAA,UAAZyC,EAAY,uEAAP,KAAO;AACtC,UAAMvC,MAAM,GAAGF,KAAK,GAAGA,KAAK,CAAC+Q,aAAT,GAAyBtO,EAA7C;AACA,UAAMmgB,OAAO,GAAGxjB,gBAAC,CAACc,MAAD,CAAjB;AAFsC,UAG9B0c,KAH8B,GAGpB1c,MAHoB,CAG9B0c,KAH8B;AAKtC,UAAIiG,QAAQ,GAAGjG,KAAK,CAAC1a,MAAN,GAAe,CAA9B;;AAEA,UAAI;AACF2gB,gBAAQ,GAAGA,QAAQ,IAAID,OAAO,CAACxC,EAAR,CAAW,mBAAX,CAAvB;AACAwC,eAAO,CAAClK,WAAR,CAAoB,KAAK0J,WAAzB,EAAsCS,QAAtC;AACD,OAHD,CAGE,OAAOvhB,CAAP,EAAU;AACVshB,eAAO,CAAClK,WAAR,CAAoB,KAAK0J,WAAzB,EAAsCS,QAAtC;AACD;AACF;;;;;;;;;;;;;;;;;;;;;;;;;ACxDH;AACA;;IAEqBC,Q;AACnB,oBAAYjhB,GAAZ,EAAiB;AAAA;;AACf,SAAKA,GAAL,GAAWA,GAAX;;AACA,SAAKkhB,kBAAL;;AACA,SAAKC,cAAL,GAAsB,IAAtB;;AAEA,QAAI,KAAKnhB,GAAL,CAASK,MAAb,EAAqB;AACnB,WAAK8gB,cAAL,GAAsB,IAAIC,sDAAJ,CAAmBphB,GAAG,CAACqhB,GAAJ,CAAQ,CAAR,CAAnB,EAA+B;AACnD3Z,cAAM,EAAE,MAD2C;AAEnD4Z,oBAAY,EAAE;AAFqC,OAA/B,CAAtB;AAKAC,oDAAO,CAAC,MAAD,CAAP;AACD;AACF;;;;6BAEQ;AACP,UAAI,KAAKJ,cAAT,EAAyB;AACvB,aAAKA,cAAL,CAAoBzd,MAApB;AACD;AACF;AAED;;;;;;;;yCAKqB;AACnB,UAAM8d,OAAO,GAAG,KAAKxhB,GAAL,CAASnB,IAAT,CAAc,iBAAd,EAAiCgc,MAAjC,CAAwC,UAACnN,CAAD,EAAI9M,EAAJ;AAAA,eAAWA,EAAE,CAACmb,IAAH,CAAQ9U,OAAR,CAAgB6U,QAAQ,CAAC2F,QAAzB,MAAuC,CAAC,CAAnD;AAAA,OAAxC,CAAhB;AACAD,aAAO,CAAChD,IAAR,CAAa,QAAb,EAAuB,QAAvB;AACD","file":"DynamicFeaturedCollection-DynamicProduct-StaticCollection-StaticProduct-StaticProductRecommendations-724f8050.bundle.js","sourcesContent":["import $ from 'jquery';\n\nexport default class MessageBanner {\n  constructor() {\n    this.$window = $(window);\n    this.$document = $(document);\n    this.$body = $(document.body);\n    this.$bannerTemplate = $('[data-templates] [data-message-banner]');\n    this.$banners = [];\n\n    this.header = document.querySelector('[data-site-header]');\n    this.events = [];\n\n    this.$document.on('touchstart.message-banner, click.message-banner', event => {\n      this._handleDocumentClick(event.target);\n    });\n\n    this.$window.on('keydown.message-banner', event => this._closeEsc(event));\n  }\n\n  unload() {\n    this.$document.off('touchstart.message-banner, click.message-banner');\n    this.$window.off('keydown.message-banner');\n  }\n\n  message(message, type) {\n    const $banner = this.$bannerTemplate.clone();\n\n    $banner\n      .addClass(`message--${type}`)\n      .find('[data-message-banner-content]')\n      .html(message);\n\n    $(this.header).append($banner);\n    this._bindEvents($banner);\n    this._show($banner);\n  }\n\n  dismissBanners() {\n    const $visibleBanners = $('[data-message-banner]:visible');\n\n    $visibleBanners.each((index, banner) => {\n      this._hide($(banner), index);\n    });\n  }\n\n  _bindEvents($banner) {\n    this.events.push([\n      $banner.on('click.message-banner', '[data-message-banner-close]', event => {\n        event.preventDefault();\n        this._hide($banner);\n      }),\n      this.$window.on('keydown.message-banner', e => {\n        if (e.key === 'Escape') {\n          this._hide($banner);\n        }\n      }),\n    ]);\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this.dismissBanners();\n    }\n  }\n\n  _show($banner) {\n    this.$banners.push($banner);\n\n    $banner\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n      });\n  }\n\n  _hide($banner, index = 0) {\n    $banner\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-out visible')\n          .off('trend');\n        this._removeBanner($banner, index);\n      });\n  }\n\n  _removeBanner($banner, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.message-banner'));\n      this.events.splice(index, 1);\n    }\n\n    this.$banners.splice(index, 1);\n    $banner.remove();\n  }\n\n  _handleDocumentClick(target) {\n    const $parent = $(target).parents('[data-message-banner]');\n    if ($parent.length) return;\n\n    this.dismissBanners();\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://www.youtube.com/iframe_api';\nlet apiLoadedCallbacks = [];\nlet apiLoaded = false;\n\nwindow.onYouTubeIframeAPIReady = () => {\n  apiLoadedCallbacks.forEach(apiLoadedCallback => apiLoadedCallback());\n  apiLoadedCallbacks = [];\n  apiLoaded = true;\n};\n\nexport default class Youtube {\n  constructor({ el, videoUrl, loop }) {\n    const regex = /(?:youtube\\.com\\/(?:[^\\/]+\\/.+\\/|(?:v|e(?:mbed)?)\\/|.*[?&]v=)|youtu\\.be\\/)([^\"&?\\/ ]{11})/i; // eslint-disable-line no-useless-escape\n\n    this.el = el;\n    this.id = videoUrl.match(regex)[1] || null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.isReady = false;\n    this.onReady = this._onReady.bind(this);\n    this.onReadyCallback = null;\n    this.loop = loop ? 1 : 0;\n\n    this.onStateChange = this._onStateChange.bind(this);\n    this.onPlayCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      apiLoadedCallbacks.push(this.onApiLoaded);\n      $script(api);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.playVideo(); };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.pauseVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.pauseVideo(); };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n        this.player.mute();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.playVideo();\n          this.player.mute();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player.destroy();\n  }\n\n  _onApiLoaded() {\n    const playerVars = {\n      modestbranding: true,\n      showinfo: false,\n      controls: false,\n      loop: this.loop,\n      rel: 0,\n    };\n\n    if (this.loop) {\n      // This is required to allow 'loop' to work based on the YouTube api\n      playerVars.playlist = this.id;\n    }\n\n    this.player = new YT.Player(this.el, {\n      videoId: this.id,\n      playerVars,\n      events: {\n        onReady: this.onReady,\n        onStateChange: this.onStateChange,\n      },\n    });\n  }\n\n  _onReady() {\n    this.isReady = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onStateChange(event) {\n    const state = event.data;\n    if (\n      this.onPlayCallback\n      && state === YT.PlayerState.BUFFERING\n    ) {\n      this.onPlayCallback();\n      this.onPlayCallback = null;\n    }\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://player.vimeo.com/api/player.js';\nlet apiLoaded = false;\n\nexport default class VimeoPlayer {\n  constructor({ el, videoUrl }) {\n    this.el = el;\n    const urlParts = videoUrl.split('/');\n\n    this.id = urlParts[urlParts.length - 1];\n    this.onReadyCallback = null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.onProgress = this._onProgress.bind(this);\n    this.onProgressCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      $script(api, this.onApiLoaded);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('pause', this.onProgress);\n        this.player.pause();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('pause', this.onProgress);\n          this.player.pause();\n        };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.setVolume(0);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.setVolume(0);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player\n      .unload()\n      .catch();\n  }\n\n  _onApiLoaded() {\n    this.player = new window.Vimeo.Player(this.el, { id: this.id });\n\n    this.player\n      .ready()\n      .then()\n      .catch();\n\n    apiLoaded = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onProgress() {\n    this.player.off('play', this.onProgress);\n    this.player.off('pause', this.onProgress);\n\n    if (this.onProgressCallback) {\n      this.onProgressCallback();\n      this.onProgressCallback = null;\n    }\n  }\n}\n","import Youtube from './Youtube';\nimport Vimeo from './Vimeo';\n\nexport default class Video {\n  constructor(el, options) {\n    this.el = el;\n    this.options = options;\n    this.platform = el.getAttribute('data-video').trim();\n    this.playButton = el.querySelector('[data-video-play-button]');\n    this.videoEl = el.querySelector('[data-video-element]');\n\n    this.onPlayClick = this._onPlayClick.bind(this);\n    this.onPauseClick = this._onPauseClick.bind(this);\n    this.autoplay = this._autoplay.bind(this);\n\n    this.video = null;\n\n    this.videoData = {\n      el: this.videoEl.childNodes[0],\n      videoUrl: this.videoEl.getAttribute('data-video-url'),\n      loop: this.options && this.options.loop,\n    };\n\n    switch (this.platform) {\n      case 'youtube':\n        this.video = new Youtube(this.videoData);\n        break;\n      case 'vimeo':\n        this.video = new Vimeo(this.videoData);\n        break;\n      default:\n        this.video = null;\n        break;\n    }\n\n    this.el.addEventListener('click', this.onPlayClick);\n\n    if (this.playButton) {\n      if (this.options && this.options.autoplay) {\n        this.autoplay();\n      }\n\n      this.playButton.addEventListener('click', this.onPlayClick);\n    }\n  }\n\n  _onPlayClick() {\n    this.el.classList.add('video-loading');\n\n    this.video.play()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  _onPauseClick() {\n    this.video.pause();\n  }\n\n  _autoplay() {\n    this.el.classList.add('video-loading');\n\n    this.video.autoplay()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  play() {\n    this._onPlayClick();\n  }\n\n  pause() {\n    this._onPauseClick();\n  }\n\n  unload() {\n    this.el.removeEventListener('click', this.onPlayClick);\n\n    if (this.playButton) {\n      this.playButton.removeEventListener('click', this.onPlayClick);\n    }\n\n    if (this.video) {\n      this.video.unload();\n    }\n  }\n\n  destroy() {\n    this.unload();\n  }\n}\n","import PhotoSwipe from 'photoswipe';\nimport EventHandler from '@pixelunion/events';\nimport rimg from 'rimg-shopify';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport photoswipeUi from '../../../node_modules/photoswipe/dist/photoswipe-ui-default';\n\nimport layout from '../Layout';\n\nexport default class ProductClickToZoom {\n  constructor({\n    settings,\n    slides,\n    originalThumbnails,\n    startIndex,\n    selectGalleryIndex,\n  }) {\n    this.settings = settings;\n\n    this.photoswipeDialog = document.querySelector('[data-photoswipe]');\n    this.thumbContainer = this.photoswipeDialog.querySelector('[data-photoswipe-thumbs]');\n    this.thumbScroller = this.photoswipeDialog.querySelector('[data-photoswipe-thumb-scroller]');\n    this.thumbScrollerButtons = this.photoswipeDialog.querySelectorAll('[data-gallery-scroll-button]');\n    this.closeButton = this.photoswipeDialog.querySelector('.pswp__button--close');\n    this.selectedSlide = slides[startIndex];\n\n    this.thumbScroller.innerHTML = '';\n    this.thumbnails = [];\n\n    let selectedIndex = startIndex;\n\n    // Clone the original thumbnails into the photoswipe dialog\n    originalThumbnails.forEach((thumb, thumbIndex) => {\n      if (thumb.dataset.mediaType !== 'image') {\n        if (startIndex > thumbIndex) selectedIndex--;\n        return;\n      }\n      const newThumb = thumb.cloneNode(true);\n      this.thumbScroller.appendChild(newThumb);\n      this.thumbnails.push(newThumb);\n    });\n\n    rimg.watch(this.thumbContainer);\n\n    this.selectedThumb = this.thumbContainer.querySelector('[data-gallery-selected=\"true\"]');\n\n    this.events = new EventHandler();\n\n    // Set up options for initializing PhotoSwipe\n    const photoswipeSlides = [];\n\n    slides.forEach(slide => {\n      if (['video', 'external_video', 'model'].indexOf(slide.dataset.mediaType) > -1) return;\n      photoswipeSlides.push({\n        src: slide.dataset.zoom,\n        msrc: slide.dataset.zoom,\n        h: slide.dataset.imageHeight,\n        w: slide.dataset.imageWidth,\n      });\n    });\n\n    // Adjust the bottom bar height to allow for the mobile thumbnails\n    const bottomBarHeight = layout.isGreaterThanBreakpoint('L', true) ? 0 : 75;\n\n    const photoswipeOptions = {\n      index: selectedIndex,\n      barsSize: { top: 0, bottom: bottomBarHeight },\n      fullscreenEl: false,\n      zoomEl: false,\n      shareEl: false,\n      counterEl: false,\n      arrowEl: false,\n      preloaderEl: false,\n      closeOnScroll: false,\n      showHideOpacity: true,\n      history: false,\n      loop: true,\n      clickToCloseNonZoomable: false,\n      timeToIdle: false,\n      timeToIdleOutside: false,\n    };\n\n    if (this.settings.click_to_zoom === 'always'\n      || (layout.isGreaterThanBreakpoint('S', true) && this.settings.click_to_zoom === 'desktop')\n      || (layout.isLessThanBreakpoint('S') && this.settings.click_to_zoom === 'mobile')) {\n      photoswipeOptions.getThumbBoundsFn = () => {\n        const pageYScroll = window.pageYOffset || document.documentElement.scrollTop;\n        const bounds = this.selectedSlide.querySelector('[data-rimg]').getBoundingClientRect();\n        return { x: bounds.left, y: bounds.top + pageYScroll, w: bounds.width };\n      };\n    }\n\n    this.photoswipe = new PhotoSwipe(\n      this.photoswipeDialog,\n      photoswipeUi,\n      photoswipeSlides,\n      photoswipeOptions,\n    );\n\n    this.events.register(this.closeButton, 'click', () => this.photoswipe.close());\n    // The following fixes an issue on iOS12 and below, where click events were not registering\n    this.events.register(this.closeButton, 'touchstart', () => this.photoswipe.close());\n\n    this.thumbnails.forEach((thumb, index) => {\n      this.events.register(thumb, 'click', () => {\n        this.photoswipe.goTo(index);\n      });\n    });\n\n    this.events.register(this.thumbScroller, 'scroll', () => this._handleScrollButtonVisibility());\n    this.events.register(this.thumbScrollerButtons[0], 'click', () => this._onScrollButtonClick(true));\n    this.events.register(this.thumbScrollerButtons[1], 'click', () => this._onScrollButtonClick(false));\n\n    // Photoswipe documentation claims that the closeOnVerticalDrag option is always false if\n    // the mouse is used, which is what we want. Unfortunately that's not how it actually works,\n    // so we need to dynamically update the setting when a mouse is detected.\n    if (this.photoswipe.options.mouseUsed) {\n      this.photoswipe.options.closeOnVerticalDrag = false;\n    } else {\n      this.photoswipe.listen('mouseUsed', () => {\n        this.photoswipe.options.closeOnVerticalDrag = false;\n      });\n    }\n\n    this.photoswipe.listen('afterChange', () => {\n      const index = this.photoswipe.getCurrentIndex();\n      if (this.selectedThumb) {\n        this.selectedThumb.dataset.gallerySelected = false;\n      }\n      this.selectedThumb = this.thumbnails[index];\n      this.selectedThumb.dataset.gallerySelected = true;\n\n      const slideIndex = this.selectedThumb.getAttribute('data-gallery-index');\n      const slide = slides[slideIndex];\n\n      this._adjustMobileThumbPosition();\n      this._handleScrollButtonVisibility();\n\n      selectGalleryIndex(slideIndex);\n      this.selectedSlide = slide;\n    });\n\n    this.photoswipe.listen('close', () => {\n      removeTrapFocus(this.photoswipeDialog);\n      this.selectedSlide.focus();\n      this.photoswipe = null;\n    });\n\n    this.photoswipe.listen('destroy', () => {\n      this.events.unregisterAll();\n      this.photoswipe = null;\n    });\n\n    // Detect if mouse is over the thumbnails, if it is allow scroll left/right\n    this.events.register(this.thumbContainer, 'mouseenter', () => {\n      if (layout.isLessThanBreakpoint('S')) {\n        this.photoswipe.options.closeOnScroll = true;\n      }\n    });\n\n    this.events.register(this.thumbContainer, 'mouseleave', () => {\n      if (layout.isLessThanBreakpoint('S')) {\n        this.photoswipe.options.closeOnScroll = false;\n      }\n    });\n\n    // If a user closes the dialog using the escape key, then we should focus\n    // on the expand button.\n    const closeEsc = e => {\n      if (e.key === 'Escape') {\n        slides[0].parentNode.querySelector('[data-gallery-expand]').focus();\n      }\n    };\n\n    this.events.register(window, 'keydown', e => closeEsc(e));\n\n    this.photoswipe.init();\n\n    trapFocus(this.photoswipeDialog);\n  }\n\n  _adjustMobileThumbPosition() {\n    // This brings the thumbnail into view if it is not visible on the screen after\n    // a user swipes to a slide that it is tied to.\n    if (layout.isLessThanBreakpoint('S')) {\n      const thumbBounds = this.selectedThumb.getBoundingClientRect();\n      const thumbWrapperBounds = this.thumbScroller.getBoundingClientRect();\n\n      if (thumbBounds.left + thumbBounds.width + 30 > thumbWrapperBounds.width) {\n        this.thumbScroller.scrollLeft = this.selectedThumb.offsetLeft\n          + thumbBounds.width - thumbWrapperBounds.width + 35;\n      } else if (this.selectedThumb.offsetLeft < this.thumbScroller.scrollLeft) {\n        this.thumbScroller.scrollLeft = this.selectedThumb.offsetLeft - 35;\n      }\n    }\n  }\n\n  _handleScrollButtonVisibility() {\n    if (layout.isLessThanBreakpoint('S')) {\n      // We use 4px here just to ensure the user has scrolled a little bit before\n      // showing the buttons.\n      if (this.thumbScroller.scrollLeft > 4) {\n        this.thumbScrollerButtons[0].classList.add('visible');\n      } else {\n        this.thumbScrollerButtons[0].classList.remove('visible');\n      }\n\n      if (this.thumbScroller.scrollLeft < this.thumbScroller.scrollWidth\n        - this.thumbScroller.clientWidth) {\n        this.thumbScrollerButtons[1].classList.add('visible');\n      } else {\n        this.thumbScrollerButtons[1].classList.remove('visible');\n      }\n    } else {\n      this.thumbScrollerButtons[0].classList.remove('visible');\n      this.thumbScrollerButtons[1].classList.remove('visible');\n    }\n  }\n\n  _onScrollButtonClick(scrollRight) {\n    if (scrollRight) {\n      this.thumbScroller.scrollLeft = this.thumbScroller.scrollLeft - 100;\n    } else {\n      this.thumbScroller.scrollLeft = this.thumbScroller.scrollLeft + 100;\n    }\n  }\n\n  unload() {\n    if (this.photoswipe) {\n      this.photoswipe.destroy();\n      this.photoswipe = null;\n    }\n  }\n}\n","import Drift from 'drift-zoom';\nimport Flickity from 'flickity';\nimport EventHandler from '@pixelunion/events';\nimport rimg from 'rimg-shopify';\n\nimport layout from '../Layout';\nimport Video from './Video';\nimport ProductClicktoZoom from './ProductClickToZoom';\n\nexport default class ProductGallery {\n  constructor({ el, settings, isQuickshop }) {\n    this.el = el;\n    this.settings = settings;\n    this.isQuickshop = isQuickshop || false;\n\n    this.events = new EventHandler();\n    this.viewer = this.el.querySelector('[data-gallery-viewer]');\n    this.navigation = this.el.querySelector('[data-gallery-navigation]');\n    this.navScroller = this.el.querySelector('[data-gallery-scroller]');\n    this.navScrollerButtons = this.el.querySelectorAll('[data-gallery-scroll-button]');\n    this.figures = this.viewer.querySelectorAll('[data-gallery-figure]');\n    this.thumbnails = this.navigation.querySelectorAll('[data-gallery-thumbnail]');\n    this.zoomButton = this.viewer.querySelector('[data-gallery-expand]');\n\n    this.selected = {\n      figure: this.viewer.querySelector('[data-gallery-selected=\"true\"]'),\n      thumbnail: this.navigation.querySelector('[data-gallery-selected=\"true\"]'),\n    };\n\n    this.models = {};\n    this.videos = {};\n    this.selectedVideo = null;\n    this.selectedModel = null;\n    this.showingInitialSlide = true;\n\n    this._setupSelectedVideo = this._setupSelectedVideo.bind(this);\n\n    const features = [];\n    if (this.el.querySelector('[data-media-type=\"video\"]')) {\n      features.push({\n        name: 'video-ui',\n        version: '1.0',\n        onLoad: () => this._setupSelectedVideo(),\n      });\n    }\n\n    if (this.el.querySelector('[data-media-type=\"model\"]')) {\n      this.viewInYourSpaceEl = this.el.querySelector('[data-shopify-xr]');\n      this.events.register(this.viewInYourSpaceEl, 'click', () => this._onViewInYourSpaceClick());\n\n      features.push(\n        {\n          name: 'model-viewer-ui',\n          version: '1.0',\n          onLoad: this._onModelLibraryLoad.bind(this),\n        },\n      );\n      features.push(\n        {\n          name: 'shopify-xr',\n          version: '1.0',\n        },\n      );\n    }\n\n    if (features.length) {\n      window.Shopify.loadFeatures(features);\n    }\n\n    if (this.isQuickshop) {\n      rimg.watch(this.el);\n      // Because of the way the quickshop is animated to open, if a video is first in the\n      // gallery the height of the slide will not be correct, so we need to wait until all the\n      // transitions end. This will only fire once, as opposed to listening to transitionend.\n      if (this.figures[0].dataset.mediaType === 'video') {\n        setTimeout(() => this._setSlideHeight(), 800);\n      }\n    }\n\n    this.events.register(this.navScroller, 'click', e => this._onThumbnailClick(e));\n    this.events.register(this.navScroller, 'scroll', () => this._handleScrollButtonVisibility());\n    this.events.register(this.navScrollerButtons[0], 'click', () => this._onScrollButtonClick(true));\n    this.events.register(this.navScrollerButtons[1], 'click', () => this._onScrollButtonClick(false));\n\n    if (this.settings.click_to_zoom !== 'disabled') {\n      const onZoomButtonClick = e => {\n        e.stopPropagation();\n        this._openImageZoom();\n      };\n\n      this.events.register(this.zoomButton, 'click', e => onZoomButtonClick(e));\n      this.events.register(this.viewer, 'click', e => onZoomButtonClick(e));\n    }\n\n    this._onResize = this._onResize.bind(this);\n    this.events.register(window, 'resize', () => this._onResize());\n\n    if (layout.isLessThanBreakpoint('S')) {\n      this._setupFlickity();\n      this._handleScrollButtonVisibility();\n    }\n\n    this._selectMediaByEl(this.selected.figure);\n  }\n\n  selectMediaByVariant(variant) {\n    if (!variant.featured_media) return;\n    const slide = this.viewer.querySelector(`[data-media=\"${variant.featured_media.id}\"]`);\n\n    this._selectMediaByEl(slide);\n  }\n\n  unload() {\n    this.events.unregisterAll();\n\n    for (let i; i < this.figures.length; i++) {\n      if (this.models[i]) {\n        this.models[i].destroy();\n      }\n\n      if (this.videos[i]) {\n        this.videos[i].destroy();\n      }\n    }\n\n    if (this.isQuickshop) {\n      rimg.unwatch(this.el);\n    }\n\n    this._closeImageZoom();\n    this._disableHoverZoom();\n    this._disableFlickity();\n  }\n\n  _onModelLibraryLoad() {\n    const onPlayListener = () => {\n      if (this.flickity) {\n        this.flickity.unbindDrag();\n      }\n    };\n    const onPauseListener = () => {\n      if (this.flickity) {\n        this.flickity.bindDrag();\n      }\n    };\n    this.el.querySelectorAll('.product-gallery--model')\n      .forEach(figureEl => {\n        const modelEl = figureEl.querySelector('model-viewer');\n        const { galleryIndex } = figureEl.dataset;\n        const controls = ['zoom-in', 'zoom-out'];\n        if (document.fullscreenEnabled) controls.push('fullscreen');\n\n        this.models[galleryIndex] = new Shopify.ModelViewerUI(modelEl, { controls });\n\n        this.events.register(modelEl, 'shopify_model_viewer_ui_toggle_play', onPlayListener);\n        this.events.register(modelEl, 'shopify_model_viewer_ui_toggle_pause', onPauseListener);\n      });\n  }\n\n  _onResize() {\n    // If the resize was trigger by a fullscreen, do not do anything\n    if (document.fullscreenElement) {\n      return;\n    }\n\n    if (layout.isGreaterThanBreakpoint('S', true)) {\n      this._disableFlickity();\n    } else {\n      this._setupFlickity();\n    }\n\n    if (layout.isGreaterThanBreakpoint('L', true) && !this.drift) {\n      this._setupHoverZoom();\n    } else if (layout.isLessThanBreakpoint('L')) {\n      this._disableHoverZoom();\n    }\n\n    this._adjustGalleryPositioning();\n    this._handleScrollButtonVisibility();\n  }\n\n  _onThumbnailClick(e) {\n    let button;\n    this.showingInitialSlide = false;\n\n    // The target will be the button itself if the user is using a keyboard to navigate, but\n    // otherwise it will be the image that is clicked on.\n    if (e.target.classList.contains('product-gallery--media-thumbnail')) {\n      button = e.target;\n    } else if (e.target.parentNode.parentNode.classList\n      .contains('product-gallery--media-thumbnail')) {\n      button = e.target.parentNode.parentNode;\n    } else {\n      return;\n    }\n\n    const selectedIndex = parseInt(button.dataset.galleryIndex, 10);\n\n    if (this.flickity) {\n      this.flickity.select(selectedIndex);\n    } else {\n      this._selectMediaByIndex(selectedIndex);\n    }\n  }\n\n  _onViewInYourSpaceClick(e) {\n    const { currentTarget } = e;\n    const figure = this.viewer.querySelector(`[data-media=\"${currentTarget.dataset.shopifyModel3dId}\"]`);\n\n    this._selectMediaByEl(figure);\n  }\n\n  _selectMediaByEl(el) {\n    this._selectMediaByIndex(parseInt(el.dataset.galleryIndex, 10));\n  }\n\n  _selectMediaByIndex(index) {\n    const figure = this.figures[index];\n\n    this.selected.figure.dataset.gallerySelected = false;\n    this.selected.figure.setAttribute('aria-hidden', true);\n    this.selected.figure = figure;\n    this.selected.figure.dataset.gallerySelected = true;\n    this.selected.figure.setAttribute('aria-hidden', false);\n\n    const figureIndex = parseInt(this.selected.figure.dataset.galleryIndex, 10);\n\n    this.selected.thumbnail.dataset.gallerySelected = false;\n    this.selected.thumbnail = this.thumbnails[figureIndex];\n    this.selected.thumbnail.dataset.gallerySelected = true;\n\n    const { media, mediaType } = this.selected.figure.dataset;\n\n    this.viewer.dataset.selectedMediaType = mediaType;\n\n    this._disableHoverZoom();\n\n    if (this.selectedModel) {\n      this.selectedModel.pause();\n    }\n\n    if (this.models[figure.dataset.galleryIndex]) {\n      this.selectedModel = this.models[figure.dataset.galleryIndex];\n      if (!document.documentElement.classList.contains('has-touch') && !this.showingInitialSlide) {\n        this.selectedModel.play();\n      }\n    }\n\n    if (this.selectedVideo) {\n      this.selectedVideo.pause();\n    }\n\n    if (this.viewInYourSpaceEl) {\n      this.viewInYourSpaceEl.dataset.shopifyModel3dId = this.viewInYourSpaceEl.dataset.defaultModelId;\n    }\n\n    switch (mediaType) {\n      case 'model':\n        this.viewInYourSpaceEl.dataset.shopifyModel3dId = media;\n        break;\n      case 'video':\n      case 'external_video':\n        this._setupSelectedVideo();\n        break;\n      case 'image':\n        this._setupHoverZoom();\n        break;\n      default: break;\n    }\n\n    if (this.flickity) {\n      this.flickity.bindDrag();\n      this.flickity.select(index);\n    }\n\n    this._adjustGalleryPositioning();\n  }\n\n  _setupSelectedVideo() {\n    if (this.selectedVideo) {\n      this.selectedVideo.pause();\n    }\n\n    const { mediaType, galleryIndex } = this.selected.figure.dataset;\n    const shouldAutoplay = layout.isGreaterThanBreakpoint('L', true)\n      && this.settings.gallery_video_autoplay\n      && !this.showingInitialSlide;\n\n    if (mediaType === 'video' || mediaType === 'external_video') {\n      let videoElement;\n\n      if (this.videos[galleryIndex]) {\n        this.selectedVideo = this.videos[galleryIndex];\n        if (shouldAutoplay) this.selectedVideo.play();\n      } else {\n        if (mediaType === 'video') {\n          // Plyr hasn't loaded yet, will be called again after loadFeatures\n          if (!Shopify.Plyr) return;\n          videoElement = this.selected.figure.querySelector('video');\n\n          this.selectedVideo = new Shopify.Plyr(videoElement, {\n            loop: { active: this.settings.gallery_video_looping },\n          });\n          if (shouldAutoplay) this.selectedVideo.play();\n        } else {\n          videoElement = this.selected.figure.querySelector('[data-video]');\n          this.selectedVideo = new Video(videoElement, {\n            loop: this.settings.gallery_video_looping,\n          });\n          if (shouldAutoplay) this.selectedVideo.play();\n        }\n        this.videos[galleryIndex] = this.selectedVideo;\n      }\n      this.selected.figure.focus();\n    }\n  }\n\n  _setupHoverZoom() {\n    if (\n      this.settings.hover_zoom === 'disabled'\n      || !layout.isGreaterThanBreakpoint('L', true)\n      || this.selected.figure.dataset.mediaType !== 'image'\n      || document.documentElement.classList.contains('has-touch')\n    ) return;\n\n    const selectedImage = this.selected.figure.querySelector('[data-rimg]');\n    selectedImage.setAttribute('data-zoom', this.selected.figure.getAttribute('data-zoom'));\n\n    this.drift = new Drift(selectedImage, {\n      paneContainer: this.settings.hover_zoom === 'separate'\n        ? this.el.querySelector('[data-zoomed-image]')\n        : this.selected.figure,\n      inlinePane: false,\n      hoverBoundingBox: this.settings.hover_zoom === 'separate',\n      handleTouch: false,\n      onShow: () => {\n        if (this.settings.hover_zoom === 'separate') {\n          const productMain = document.querySelector('.product-main');\n          const productAlt = document.querySelector('.product-form--alt');\n          productMain.classList.add('product-gallery--fade');\n          if (productAlt) productAlt.classList.add('product-gallery--fade');\n        }\n      },\n      onHide: () => {\n        if (this.settings.hover_zoom === 'separate') {\n          const productMain = document.querySelector('.product-main');\n          const productAlt = document.querySelector('.product-form--alt');\n          productMain.classList.remove('product-gallery--fade');\n          if (productAlt) productAlt.classList.remove('product-gallery--fade');\n        }\n      },\n    });\n  }\n\n  _disableHoverZoom() {\n    if (this.drift) {\n      this.drift.disable();\n      this.drift = null;\n    }\n  }\n\n  _setupFlickity() {\n    if (\n      this.flickity\n      || !layout.isLessThanBreakpoint('S')\n    ) return;\n\n    this.flickity = new Flickity(this.viewer, {\n      accessibility: false,\n      adaptiveHeight: true,\n      cellSelector: '.product-gallery--media',\n      contain: true,\n      friction: 0.5,\n      freeScroll: false,\n      initialIndex: parseInt(this.selected.figure.dataset.galleryIndex, 10),\n      lazyLoad: false,\n      percentPosition: false,\n      prevNextButtons: false,\n      pageDots: false,\n      selectedAttraction: 0.1,\n      setGallerySize: false,\n      wrapAround: true,\n    });\n\n    this.flickityEvent = this.events.register(this.viewer, 'rimg:load', () => {\n      this._setSlideHeight();\n    });\n\n    this.flickity.on('change', index => {\n      this.showingInitialSlide = false;\n      this._selectMediaByEl(this.figures[index]);\n    });\n\n    // Flickity controls the pointerdown event which prevents model-viewer-ui from\n    // triggering .play() on mouseup. This returns this functionality.\n    this.flickity.on('staticClick', (event, pointer, cellElement) => {\n      const figure = cellElement.querySelector('.product-gallery--model');\n\n      if (figure && this.models[figure.dataset.galleryIndex]) {\n        const model = this.models[figure.dataset.galleryIndex];\n        model.play();\n      }\n    });\n\n    this.flickity.on('pointerDown', () => {\n      // Removes the focus ring when swiping with touch device\n      this.viewer.blur();\n    });\n\n    // We need to disable the product zoom open if a user is swiping\n    // This was an issue on mouse gestures, not on touch\n    if (this.settings.click_to_zoom !== 'disabled'\n      && document.documentElement.classList.contains('no-touch')) {\n      this.flickity.on('dragEnd', () => {\n        this.swiped = true;\n      });\n    }\n\n    this._setSlideHeight();\n  }\n\n  _disableFlickity() {\n    if (this.flickity) {\n      this.flickity.destroy();\n      this.flickity = null;\n      this.events.unregister(this.flickityEvent);\n    }\n  }\n\n  _setSlideHeight() {\n    this.navigation.classList.remove('loading');\n\n    // Use the stored image height for situations where the DOM is in a midway state.\n    const containerHeight = this.storedImageHeight\n      || this.selected.figure.getBoundingClientRect().height;\n    this.storedImageHeight = null;\n\n    this.viewer.style.height = `${containerHeight}px`;\n  }\n\n  _adjustGalleryPositioning() {\n    if (this.settings.thumbnail_position === 'left') {\n      if (this.isQuickshop) {\n        if (layout.isGreaterThanBreakpoint('L', true)) {\n          this.el.dataset.productGalleryThumbs = 'left';\n        } else {\n          this.storedImageHeight = this.selected.figure.getBoundingClientRect().height;\n          this.el.dataset.productGalleryThumbs = 'center';\n        }\n      }\n\n      // We need to adjust the width of the thumbnails if they are positioned left\n      // and they wrap into 2 columns. CSS flexbox does not cause the width of the\n      // element to stretch. Looks like it's a problem with flexbox when wrapping columns:\n      // https://stackoverflow.com/questions/33891709/when-flexbox-items-wrap-in-column-mode-container-does-not-grow-its-width\n      if (layout.isGreaterThanBreakpoint('L', true)\n        || (layout.isGreaterThanBreakpoint('S', true) && !this.isQuickshop)) {\n        if (this.el.firstChild !== this.navigation) {\n          const activeButton = document.activeElement;\n          this.el.insertBefore(this.navigation, this.viewer);\n          activeButton.focus(); // This prevents loss of focus if one of the thumbnails are selected\n        }\n\n        // When switching layouts in the editor sometimes we need to wait for a few milliseconds\n        // before positioning the thumbs. The Quickshop is even a bit slower.\n        setTimeout(() => {\n          const leftmostBounds = this.thumbnails[0].getBoundingClientRect();\n          const thumbStyle = this.thumbnails[0].currentStyle\n            || window.getComputedStyle(this.thumbnails[0]);\n          const thumbMargin = (parseInt(thumbStyle.marginLeft, 10)) * 2;\n          const wrapped = Array.prototype.some.call(this.thumbnails,\n            thumb => thumb.getBoundingClientRect().left > leftmostBounds.left);\n          if (wrapped) {\n            this.navigation.style.width = `${(leftmostBounds.width + thumbMargin) * 2}px`;\n            this.navigation.style.maxWidth = `${(leftmostBounds.width + thumbMargin) * 2}px`;\n          }\n          this._setSlideHeight();\n        }, this.isQuickshop ? 500 : 100);\n      } else {\n        if (this.el.firstElementChild === this.navigation) {\n          this.el.appendChild(this.navigation);\n        }\n        this.navigation.style.width = '';\n        this.navigation.style.maxWidth = '';\n        this._setSlideHeight();\n      }\n\n      if (layout.isLessThanBreakpoint('S')) {\n        this._adjustMobileThumbnailPosition();\n      }\n    } else {\n      this._setSlideHeight();\n      this._adjustMobileThumbnailPosition();\n    }\n  }\n\n  _adjustMobileThumbnailPosition() {\n    // This brings the thumbnail into view if it is not visible on the screen after\n    // a user swipes to a slide that it is tied to. Only important on mobile.\n    if (layout.isLessThanBreakpoint('S')) {\n      const thumbBounds = this.selected.thumbnail.getBoundingClientRect();\n      const thumbWrapperBounds = this.navScroller.getBoundingClientRect();\n\n      if (this.selected.thumbnail.offsetLeft + thumbBounds.width + 30\n        - this.navScroller.scrollLeft > thumbWrapperBounds.width) {\n        this.navScroller.scrollLeft = this.selected.thumbnail.offsetLeft\n          + thumbBounds.width - thumbWrapperBounds.width + 35;\n      } else if (this.selected.thumbnail.offsetLeft < this.navScroller.scrollLeft) {\n        this.navScroller.scrollLeft = this.selected.thumbnail.offsetLeft - 35;\n      }\n    }\n  }\n\n  _handleScrollButtonVisibility() {\n    if (layout.isLessThanBreakpoint('S')) {\n      // We use 4px here just to ensure the user has scrolled a little bit before\n      // showing the buttons.\n      if (this.navScroller.scrollLeft > 4) {\n        this.navScrollerButtons[0].classList.add('visible');\n      } else {\n        this.navScrollerButtons[0].classList.remove('visible');\n      }\n\n      if (this.navScroller.scrollLeft < this.navScroller.scrollWidth\n        - this.navScroller.clientWidth) {\n        this.navScrollerButtons[1].classList.add('visible');\n      } else {\n        this.navScrollerButtons[1].classList.remove('visible');\n      }\n    } else {\n      this.navScrollerButtons[0].classList.remove('visible');\n      this.navScrollerButtons[1].classList.remove('visible');\n    }\n  }\n\n  _onScrollButtonClick(scrollRight) {\n    if (scrollRight) {\n      this.navScroller.scrollLeft = this.navScroller.scrollLeft - 100;\n    } else {\n      this.navScroller.scrollLeft = this.navScroller.scrollLeft + 100;\n    }\n  }\n\n  _closeImageZoom() {\n    if (this.imageZoom) {\n      this.imageZoom.unload();\n      this.imageZoom = null;\n    }\n  }\n\n  _openImageZoom() {\n    if (this.selected.figure.dataset.mediaType !== 'image'\n      || (layout.isGreaterThanBreakpoint('L') && this.settings.click_to_zoom === 'mobile')\n      || (layout.isLessThanBreakpoint('L') && this.settings.click_to_zoom === 'desktop')\n    ) return;\n\n    if (this.swiped) {\n      this.swiped = false;\n      return;\n    }\n\n    this._closeImageZoom();\n\n    this.imageZoom = new ProductClicktoZoom({\n      settings: this.settings,\n      slides: this.figures,\n      originalThumbnails: this.thumbnails,\n      startIndex: parseInt(this.selected.figure.dataset.galleryIndex, 10),\n      selectGalleryIndex: index => this._selectMediaByIndex(index),\n    });\n  }\n}\n","import $ from 'jquery';\nimport ShopifyVariants from 'shopify-variants';\nimport Forms from '../Forms';\nimport AddToCartFlyout from './AddToCartFlyout';\nimport ProductGallery from './ProductGallery';\n\nexport default class ProductDetails {\n  constructor(options) {\n    this.$window = $(window);\n    this.$formArea = options.$formArea;\n    this.$details = options.$details;\n    this.context = options.context;\n    this.settings = options.settings;\n    this.product = options.product;\n    this.useHistory = options.useHistory;\n    this.sectionId = options.sectionId;\n    this.initialVariant = options.initialVariant || null;\n\n    this.variantHelper = null;\n\n    this.atcCallbacks = options.atcCallbacks;\n\n    // Form\n    this.$form = this.$formArea.find('[data-product-form]');\n    this.$productAtcButton = this.$formArea.find('[data-product-atc]');\n    this.$productVariants = this.$form.find('[data-variants]');\n    this.$productOptions = this.$form.find('[data-product-option]');\n    this.detailsLink = this.$formArea[0].querySelector('[data-product-details-link]');\n    if (this.detailsLink) {\n      this.detailsBaseHref = this.detailsLink.getAttribute('href');\n    }\n\n    this.variantFields = {\n      $price: this.$details.find('[data-price]'),\n      $priceMoney: this.$details.find('[data-price] .money'),\n      $compareAtPrice: this.$details.find('[data-price-compare-at]'),\n      $compareAtPriceMoney: this.$details.find('[data-price-compare-at] .money'),\n      $badge: this.$details.find('[data-badge-sales]'),\n      $badgeMoneySaved: this.$details.find('[data-price-money-saved]'),\n      $badgePercentSaved: this.$details.find('[data-price-percent-saved]'),\n      $sku: this.$details.find('[data-product-sku]'),\n    };\n\n    this.forms = new Forms(this.$form);\n\n    if (this.product && this.product.media.length) {\n      this.gallery = new ProductGallery({\n        el: options.gallery,\n        settings: this.settings,\n        isQuickshop: options.isQuickshop,\n      });\n    }\n\n    this._bindEvents();\n    this._initOptions();\n  }\n\n  unload() {\n    this.$form.off(`.product-details-${this.sectionId}`);\n    this.$window.off(`.product-details-${this.sectionId}`);\n    this.forms.unload();\n\n    if (this.variantHelper) {\n      this.variantHelper.unload();\n    }\n\n    if (this.gallery) {\n      this.gallery.unload();\n    }\n  }\n\n  _bindEvents() {\n    this.$window.on(`shopify-variants:switch-variant.product-details-${this.sectionId}`, (event, data) => this._switchVariant(event, data));\n    this.$form.on(`submit.product-details-${this.sectionId}`, event => this._AddToCartFlyout(event));\n  }\n\n  _initOptions() {\n    if (!this.$productVariants.length) return;\n\n    this.variantHelper = new ShopifyVariants(\n      this.product,\n      this.$productVariants,\n      this.$productOptions,\n      { mixedControls: true },\n    );\n\n    this.variantHelper.selectVariant(this.initialVariant);\n  }\n\n  _switchVariant(event, data) {\n    if (data.product !== this.product) return;\n\n    const {\n      variant,\n      firstLoad,\n    } = data;\n\n    if (firstLoad) {\n      return;\n    }\n\n    // Update main select\n    this.$productVariants.val(data.variant.id);\n    this.gallery.selectMediaByVariant(variant);\n\n    // Update Variant information\n    this._updatePrice(variant);\n    this._updateSKU(variant);\n    this._updateBadge(variant);\n    this._updateButton(variant);\n    this._updateSwatchLabel(variant);\n    this._updateFullDetailsLink(variant);\n\n    if (this.useHistory) {\n      const url = `${this.product.handle}?${$.param({ variant: variant.id })}`;\n      history.replaceState({}, 'variant', url);\n    }\n  }\n\n  _updatePrice(variant) {\n    // Update compare at price\n    const hasComparePrice = (\n      !!variant.compare_at_price && variant.compare_at_price > variant.price\n    );\n    this.variantFields.$compareAtPrice.toggleClass('visible', hasComparePrice);\n    this.variantFields.$compareAtPriceMoney.text(\n      Shopify.formatMoney(variant.compare_at_price, this.settings.money_format),\n    );\n\n    // Update price\n    this.variantFields.$priceMoney.text(\n      Shopify.formatMoney(variant.price, this.settings.money_format),\n    );\n  }\n\n  _updateSKU(variant) {\n    if (variant.sku === '') {\n      this.variantFields.$sku.parent().addClass('product-sku--empty');\n    } else {\n      this.variantFields.$sku.parent().removeClass('product-sku--empty');\n    }\n\n    this.variantFields.$sku.text(variant.sku);\n  }\n\n  _updateBadge(variant) {\n    const priceSaved = variant.compare_at_price ? variant.compare_at_price - variant.price : 0;\n    this.variantFields.$badge.toggle(!!priceSaved);\n\n    if (this.variantFields.$badgeMoneySaved.length) {\n      // Update badge if it shows money saved\n      this.variantFields.$badgeMoneySaved.text(\n        Shopify.formatMoney(priceSaved, this.settings.money_format),\n      );\n    }\n\n    if (this.variantFields.$badgePercentSaved.length) {\n      // Update badge if it shows percentiles\n      const percentileSaved = Math.round((priceSaved * 100) / variant.compare_at_price);\n      this.variantFields.$badgePercentSaved.text(percentileSaved);\n    }\n  }\n\n  _updateButton(variant) {\n    if (variant.available) {\n      this.$productAtcButton.text(this.context.product_available);\n      this.$productAtcButton\n        .removeClass('disabled')\n        .prop('disabled', false);\n    } else {\n      this.$productAtcButton.text(this.context.product_unavailable);\n      this.$productAtcButton\n        .addClass('disabled')\n        .prop('disabled', true);\n    }\n  }\n\n  _updateSwatchLabel(variant) {\n    if (this.settings.swatches_enable) {\n      const swatchLabel = this.$form[0].querySelector('[data-option-swatch-value]');\n      if (swatchLabel) {\n        swatchLabel.innerText = variant.options[parseInt(swatchLabel.dataset.optionSwatchValue, 10)];\n      }\n    }\n  }\n\n  _updateFullDetailsLink(variant) {\n    if (this.detailsLink) {\n      this.detailsLink.setAttribute('href', `${this.detailsBaseHref}?variant=${variant.id}`);\n    }\n  }\n\n  _AddToCartFlyout(event) {\n    event.preventDefault();\n\n    const formData = this.$form.serializeArray();\n\n    const options = {\n      $atcButton: this.$productAtcButton,\n      settings: {\n        moneyFormat: this.settings.money_format,\n        cartRedirection: this.settings.cart_redirection,\n      },\n    };\n\n    AddToCartFlyout.init(formData, options, this.atcCallbacks);\n  }\n}\n","export default class Images {\n  /**\n   * Preloads an image in memory and uses the browsers cache to store it until needed.\n   *\n   * @param {Array} images - A list of image urls\n   * @param {String} size - A shopify image size attribute\n   */\n  preload(images, size) {\n    let imageArray = images;\n    if (typeof images === 'string') {\n      imageArray = [images];\n    }\n\n    for (let i = 0; i < imageArray.length; i++) {\n      this.loadImage(this.getSizedImageUrl(imageArray[i], size));\n    }\n  }\n\n  /**\n   * Loads and caches an image in the browsers cache.\n   *\n   * @param {string} path - An image url\n   */\n  loadImage(path) {\n    const image = new Image();\n    image.src = path;\n    return image;\n  }\n\n  /**\n   * Adds a Shopify size attribute to a URL\n   *\n   * @param src\n   * @param size\n   * @returns {*}\n   */\n  getSizedImageUrl(src = null, size) {\n    if (!size) {\n      return null;\n    }\n\n    if (size === 'master') {\n      return this.removeProtocol(src);\n    }\n\n    const match = src.match(/\\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\\?v=\\d+)?$/i);\n\n    if (match) {\n      const prefix = src.split(match[0]);\n      const suffix = match[0];\n\n      return this.removeProtocol(`${prefix[0]}_${size}${suffix}`);\n    }\n\n    console.warn(`No ${size} found for '${src}`);\n    return null;\n  }\n\n  removeProtocol(path) {\n    return path.replace(/http(s)?:/, '');\n  }\n}\n","import $ from 'jquery';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport MessageBanner from './MessageBanner';\nimport Images from '../helpers/Images';\n\nclass AddToCartFlyout {\n  constructor() {\n    this.formData = {};\n    this.settings = {};\n    this.events = [];\n    this.Images = new Images();\n    this.flyOutSelector = '[data-atc-banner]';\n    this.$atcTemplate = $(`[data-templates] ${this.flyOutSelector}`);\n    this.activeElement = null;\n    this.itemId = null;\n\n    this.atcFlyOut = document.querySelector(this.flyOutSelector);\n\n    this._onInit = this._onInit.bind(this);\n    this._onError = this._onError.bind(this);\n    this._onSuccess = this._onSuccess.bind(this);\n    this._onCloseAll = this._onCloseAll.bind(this);\n    this._handleDocumentClick = this._handleDocumentClick.bind(this);\n\n    this._closeEsc = this._closeEsc.bind(this);\n\n    this.messageBanner = new MessageBanner();\n\n    this.header = document.querySelector('[data-site-header]');\n    this.headerAnnouncement = document.querySelector('[data-site-header-announcement]');\n    this.$header = $(this.header);\n    this.$body = $(document.body);\n  }\n\n  init(formData, options, callbacks = {}) {\n    this.formData = formData;\n\n    // Allows ATC Flow to be overridden\n    this.callbacks = $.extend({\n      onInit: this._onInit,\n      onError: this._onError,\n      onSuccess: this._onSuccess,\n      onClose: this._onCloseAll,\n    }, callbacks);\n\n    const { $atcButton } = options;\n\n    this.settings = $.extend({\n      moneyFormat: null,\n      cartRedirection: false,\n    }, options.settings);\n\n    // If any FlyOuts are fully open, close them\n    this._closeFlyOuts();\n\n    this.callbacks.onInit();\n\n    this.activeElement = document.activeElement;\n\n    this._disableButton($atcButton);\n    this._updateCart($atcButton);\n  }\n\n  unload() {\n    this.messageBanner.dismissBanners();\n    this._removeFlyOuts();\n    delete this.Images;\n  }\n\n  _updateCart($atcButton) {\n    const $flyOut = this.$atcTemplate.clone();\n\n    const quantityField = this.formData.filter(data => data.name === 'quantity');\n    const quantity = quantityField[0].value;\n\n    $.ajax({\n      type: 'POST',\n      url: `${window.Theme.routes.cart_add_url}.js`,\n      data: $.param(this.formData),\n      dataType: 'json',\n    })\n      .done(response => {\n        this.itemId = response.id;\n\n        if (response.image) {\n          const imageUrl = this.Images.getSizedImageUrl(response.image, '200x');\n          this.Images.loadImage(imageUrl);\n\n          $flyOut.find('[data-atc-banner-product-image]')\n            .html(`<img src=\"${imageUrl}\" alt=\"${response.product_title}\">`);\n        }\n\n        $flyOut.find('[data-atc-banner-product-title]')\n          .text(response.product_title);\n\n        /*\n          TODO: Bring in `variant.options`, iterate through to get option\n            name for: <strong>Option name:</strong> Option\n        */\n        if (response.variant_options[0] !== 'Title' && response.variant_options[0] !== 'Default Title') {\n          $flyOut.find('[data-atc-banner-product-options]')\n            .text(response.variant_options.join(', '));\n        }\n\n        /*\n          TODO: Bring in variant, and use that to check compare_at_price\n            to see if the item is on sale\n        */\n        const $productPriceQuantity = $flyOut.find('[data-atc-banner-product-price-quantity]');\n        $productPriceQuantity.text(`${quantity}  `);\n\n        $.ajax({\n          type: 'GET',\n          url: `${window.Theme.routes.cart_url}.js`,\n          dataType: 'json',\n        })\n          .done(secondResponse => {\n            if (this.settings.cartRedirection) {\n              location.href = window.Theme.routes.cart_url;\n              return;\n            }\n\n            this.callbacks.onSuccess();\n\n            // Reset formData in case instance is never cleared\n            this.formData = {};\n\n            let lineItem = null;\n            secondResponse.items.forEach(item => {\n              if (item.id === this.itemId) {\n                if (!lineItem) {\n                  lineItem = item;\n                } else {\n                  // If there are 2 lineItems with the same id, it means that there is\n                  // likely a BOGO offer on the product. We need to grab the highest discounted\n                  // price (BOGO will be 0) while also combining with the different discounts on\n                  // the product in the discounts array.\n                  lineItem.line_level_discount_allocations = lineItem\n                    .line_level_discount_allocations.concat(item.line_level_discount_allocations);\n                  lineItem.final_price = lineItem.final_price > item.final_price\n                    ? lineItem.final_price\n                    : item.final_price;\n                  lineItem.quantity += item.quantity;\n                }\n              }\n            });\n\n            const $productPriceValue = $flyOut.find('[data-atc-banner-product-price-value]');\n            $productPriceValue.text(\n              Shopify.formatMoney(lineItem.original_price, this.settings.moneyFormat),\n            );\n\n            const $productPriceDiscounted = $flyOut.find('[data-atc-banner-product-price-discounted]');\n            if (lineItem.final_price < lineItem.original_price) {\n              $productPriceDiscounted.text(\n                Shopify.formatMoney(lineItem.final_price, this.settings.moneyFormat),\n              );\n\n              $productPriceDiscounted.show();\n              $productPriceValue.addClass('original-price');\n            } else {\n              $productPriceDiscounted.hide();\n              $productPriceValue.removeClass('original-price');\n            }\n\n            const $productDiscounts = $flyOut.find('[data-atc-banner-product-discounts]');\n            if (lineItem.line_level_discount_allocations.length > 0) {\n              const discountItemTemplate = $productDiscounts.children().first();\n              $productDiscounts.empty();\n\n              lineItem.line_level_discount_allocations.forEach(discount => {\n                const $listItem = discountItemTemplate.clone();\n                $listItem.find('.discount-title').html(discount.discount_application.title);\n                const $amount = $listItem.find('.discount-amount');\n                $amount.html(discount.amount);\n                $productDiscounts.append($listItem);\n              });\n\n              $productDiscounts.show();\n            } else {\n              $productDiscounts.hide();\n            }\n\n            const $subTotal = $flyOut.find('[data-atc-banner-cart-subtotal]');\n            $subTotal.text(\n              Shopify.formatMoney(secondResponse.total_price, this.settings.moneyFormat),\n            );\n\n            $flyOut\n              .find('[data-atc-banner-cart-button]')\n              .find('span').text(secondResponse.item_count);\n\n            this.$header.append($flyOut);\n\n            // Notifiy Header of new cart count\n            $(window).trigger('cartcount:update', { response: secondResponse });\n\n            this._bindEvents($flyOut);\n            this._openFlyOut($flyOut, $atcButton);\n          });\n      })\n      .fail(response => {\n        let errorText;\n        try {\n          const responseText = JSON.parse(response.responseText);\n          errorText = responseText.description;\n        } catch (error) {\n          errorText = `${response.status} ${response.statusText}`;\n          if (response.status === 401) {\n            errorText = `${errorText}. Try refreshing and logging in.`;\n          }\n        }\n\n        this._enableButton($atcButton);\n        this.callbacks.onError(errorText);\n      });\n  }\n\n  _onError(error) {\n    this.messageBanner.message(error, 'error');\n  }\n\n  _onInit() {\n    this.messageBanner.dismissBanners();\n  }\n\n  _onSuccess() {\n    /*\n      By default, the ATC Flyout doesn't need any additional success callbacks\n\n      The `this.callbacks.onSuccess` is used to allow other views to initiate\n      behaviour when a product has been added to the cart\n     */\n  }\n\n  _onCloseAll() {\n    /*\n      By default, the ATC Flyout doesn't need any additional close callbacks\n\n      The `this.callbacks.onClose` is used to allow other views to initiate\n      behaviour when the atc banner has been closed\n     */\n  }\n\n  _bindEvents($flyOut) {\n    this.events.push([\n      $flyOut.on('click.atc-banner', '[data-atc-banner-close]', event => {\n        event.preventDefault();\n        this._closeFlyOut($flyOut);\n      }),\n      $(document).on('touchstart.atc-banner, click.atc-banner', this._handleDocumentClick),\n    ]);\n  }\n\n  /**\n   * Trigger any existing open FlyOuts to close\n   *\n   * @private\n   */\n  _closeFlyOuts($excludeFlyOut = null) {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      const $flyOut = $(el);\n\n      if ($excludeFlyOut && $flyOut.is($excludeFlyOut)) {\n        return;\n      }\n\n      this._closeFlyOut($flyOut, index);\n    });\n\n    if (!$excludeFlyOut) {\n      this.callbacks.onClose();\n    }\n\n    window.removeEventListener('keydown', this._closeEsc);\n  }\n\n  _openFlyOut($flyOut, $atcButton) {\n    /*\n     If user has initiated a new ATC Flow before the first has finished,\n     the first FlyOut could have opened after the first attempt to close open flyouts\n    */\n    this._closeFlyOuts($flyOut);\n\n    $flyOut\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n\n        $flyOut.attr('data-flyout-active', true);\n\n        trapFocus($flyOut[0]);\n\n        window.addEventListener('keydown', this._closeEsc);\n\n        this._enableButton($atcButton);\n      });\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this._closeFlyOuts();\n    }\n  }\n\n  /**\n   * Close an open FlyOut\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _closeFlyOut($flyOut = null, index = 0) {\n    if (!$flyOut) {\n      return;\n    }\n\n    $flyOut\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-out visible')\n          .one('trend', () => {\n            $flyOut.off('trend');\n            this._removeFlyOut($flyOut, index);\n\n            // if the user clicked onto the search box, close the atc flyout and move focus\n            // to the search instead of going to the previous active element.\n            if (this.documentClickEventTarget && 'liveSearchInput' in this.documentClickEventTarget.dataset) {\n              this.documentClickEventTarget.focus();\n            } else if (this.activeElement) {\n              this.activeElement.focus();\n            }\n\n            removeTrapFocus($flyOut[0]);\n            this.callbacks.onClose();\n          });\n      });\n  }\n\n  _removeFlyOuts() {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      this._removeFlyOut($(el), index);\n    });\n  }\n\n  /**\n   * Remove the Flyout from the DOM, and clean up listeners\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _removeFlyOut($flyOut, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.atc-banner'));\n      this.events.splice(index, 1);\n    }\n\n    if ($flyOut) {\n      $flyOut.remove();\n    }\n  }\n\n  _disableButton($atcButton) {\n    $atcButton\n      .addClass('processing')\n      .prop('disabled', true);\n  }\n\n  _enableButton($atcButton) {\n    $atcButton\n      .prop('disabled', false)\n      .removeClass('processing');\n  }\n\n  _handleDocumentClick(event) {\n    const { target } = event;\n    const $parent = $(target).parents('[data-atc-banner]');\n\n    if ($parent.length) {\n      return;\n    }\n\n    this.documentClickEventTarget = target;\n    this._closeFlyOuts();\n  }\n}\n\nexport default new AddToCartFlyout();\n","import $ from 'jquery';\n\nconst eventHandlers = [];\nlet previousBreakpoint = null;\n\nfunction getBreakpoints() {\n  return window\n    .getComputedStyle(document.documentElement, ':before')\n    .getPropertyValue('content')\n    .replace(/\"/g, '')\n    .split(',');\n}\n\nfunction getBreakpoint() {\n  return window\n    .getComputedStyle(document.documentElement, ':after')\n    .getPropertyValue('content')\n    .replace(/\"/g, '');\n}\n\n$(window).on('resize', event => {\n  const currentBreakpoint = getBreakpoint();\n\n  if (previousBreakpoint !== currentBreakpoint) {\n    eventHandlers.forEach(eventHandler => {\n      eventHandler(event, {\n        previous: previousBreakpoint,\n        current: currentBreakpoint,\n      });\n    });\n  }\n\n  previousBreakpoint = currentBreakpoint;\n});\n\nfunction isLessThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison <= 0 : comparison < 0;\n}\n\nfunction isGreaterThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison >= 0 : comparison > 0;\n}\n\nfunction isBreakpoint(...breakpoints) {\n  const currentBreakpoint = getBreakpoint();\n  return breakpoints.some(breakpoint => breakpoint === currentBreakpoint);\n}\n\nfunction onBreakpointChange(eventHandler) {\n  if (eventHandlers.indexOf(eventHandler) === -1) {\n    eventHandlers.push(eventHandler);\n  }\n}\n\nfunction offBreakpointChange(eventHandler) {\n  const index = eventHandlers.indexOf(eventHandler);\n\n  if (index !== -1) {\n    eventHandlers.splice(index, 1);\n  }\n}\n\nexport default {\n  isLessThanBreakpoint,\n  isGreaterThanBreakpoint,\n  isBreakpoint,\n  onBreakpointChange,\n  offBreakpointChange,\n};\n","export default class Quantity {\n  constructor(el) {\n    this.$el = $(el);\n    this.$inputParent = this.$el.find('.form-field--qty-input');\n    this.$input = this.$el.find('[data-quantity-input]');\n    this.$selectParent = this.$el.find('.form-field--qty-select');\n    this.$select = this.$el.find('[data-quantity-select]');\n\n    this._watchSelect = this._watchSelect.bind(this);\n    this._watchInput = this._watchInput.bind(this);\n\n    this.$select.on('change.quantity', this._watchSelect);\n    this.$input.on('change.quantity', this._watchInput);\n  }\n\n  unload() {\n    this.$el.off('.quantity');\n  }\n\n  _validateValue(event) {\n    const baseValue = parseInt(event.currentTarget.value, 10);\n\n    return isNaN(baseValue) ? 1 : baseValue;\n  }\n\n  _watchSelect(event) {\n    const value = this._validateValue(event);\n\n    // Update input to match select\n    this.$input.val(value).trigger('change');\n\n    // Switch to quantity input when 10 or more\n    if (value >= 10) {\n      this.$inputParent\n        .removeClass('hidden')\n        .addClass('visible');\n\n      this.$input\n        .focus()\n        .removeAttr('tabindex')\n        .select();\n\n      this.$selectParent\n        .removeClass('visible')\n        .addClass('hidden');\n\n      this.$select.attr('tabindex', '-1');\n    }\n  }\n\n  _watchInput(event) {\n    this.$input.val(this._validateValue(event));\n  }\n}\n","import $ from 'jquery';\nimport Quantity from './helpers/Quantity';\n\nexport default class Forms {\n  constructor(el, selector = '.form-field-input') {\n    this.$el = $(el);\n    this.filledClass = 'form-field-filled';\n    this.fieldSelector = selector;\n\n    this.quantityItems = [];\n    this.$quantityWrapper = this.$el.find('[data-quantity-wrapper]');\n\n    this._toggleFilled = this._toggleFilled.bind(this);\n    this.$el.on('focus.forms', this.fieldSelector, this._toggleFilled);\n    this.$el.on('blur.forms', this.fieldSelector, this._toggleFilled);\n\n    this._checkFilled();\n\n    if (this.$quantityWrapper.length) {\n      this.$quantityWrapper.each((i, el) => {\n        this.quantityItems.push(\n          new Quantity(el),\n        );\n      });\n    }\n  }\n\n  unload() {\n    this.$el.off('.forms');\n\n    this.quantityItems.forEach(quantityItem => {\n      quantityItem.unload();\n    });\n  }\n\n  _checkFilled() {\n    this.$el.find(this.fieldSelector).each((i, el) => {\n      if ($(el).hasClass(this.filledClass)) return;\n\n      this._toggleFilled(null, el);\n    });\n  }\n\n  _toggleFilled(event = null, el = false) {\n    const target = event ? event.currentTarget : el;\n    const $target = $(target);\n    const { value } = target;\n\n    let isFilled = value.length > 0;\n\n    try {\n      isFilled = isFilled || $target.is(':-webkit-autofill');\n      $target.toggleClass(this.filledClass, isFilled);\n    } catch (e) {\n      $target.toggleClass(this.filledClass, isFilled);\n    }\n  }\n}\n","import fitvids from 'fitvids';\nimport GroupedContent from 'grouped-content';\n\nexport default class RichText {\n  constructor($el) {\n    this.$el = $el;\n    this._initExternalLinks();\n    this.groupedContent = null;\n\n    if (this.$el.length) {\n      this.groupedContent = new GroupedContent($el.get(0), {\n        layout: 'tabs',\n        intelliparse: false,\n      });\n\n      fitvids('.rte');\n    }\n  }\n\n  unload() {\n    if (this.groupedContent) {\n      this.groupedContent.unload();\n    }\n  }\n\n  /**\n   * Open links within an RTE field in a new window if they point to external domains\n   *\n   * @private\n   */\n  _initExternalLinks() {\n    const anchors = this.$el.find('a[href^=\"http\"]').filter((i, el) => el.href.indexOf(location.hostname) === -1);\n    anchors.attr('target', '_blank');\n  }\n}\n"],"sourceRoot":""}